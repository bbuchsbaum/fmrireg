# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' AR(p) whitening of data and design matrices
#'
#' Applies a causal AR filter defined by `phi_coeffs` to both `Y` and `X`
#' matrices in place.
#'
#' @param Y Numeric matrix of data (time x voxels)
#' @param X Numeric matrix of design (time x predictors)
#' @param phi_coeffs Numeric vector of AR coefficients (length p)
#' @param exact_first_ar1 Logical, apply exact scaling of first sample for AR(1)
#'
#' @keywords internal
ar_whiten_inplace <- function(Y, X, phi_coeffs, exact_first_ar1 = FALSE) {
    .Call('_fmrireg_ar_whiten_inplace', PACKAGE = 'fmrireg', Y, X, phi_coeffs, exact_first_ar1)
}

instantaneous_correlation_rcpp <- function(x, y, eta = NA_real_, tau_half = NA_real_, offset = 0L, warmup = -1L, fill = "zero") {
    .Call('_fmrireg_instantaneous_correlation_rcpp', PACKAGE = 'fmrireg', x, y, eta, tau_half, offset, warmup, fill)
}

compute_residuals_cpp <- function(X_base_fixed, data_matrix, dmat_ran) {
    .Call('_fmrireg_compute_residuals_cpp', PACKAGE = 'fmrireg', X_base_fixed, data_matrix, dmat_ran)
}

lss_compute_cpp <- function(Q_dmat_ran, residual_data) {
    .Call('_fmrireg_lss_compute_cpp', PACKAGE = 'fmrireg', Q_dmat_ran, residual_data)
}

mixed_solve_internal <- function(y_in, Z_in = NULL, K_in = NULL, X_in = NULL, method = "REML", bounds = as.numeric( c(1e-9, 1e9)), SE = FALSE, return_Hinv = FALSE) {
    .Call('_fmrireg_mixed_solve_internal', PACKAGE = 'fmrireg', y_in, Z_in, K_in, X_in, method, bounds, SE, return_Hinv)
}

neural_input_rcpp <- function(x, from, to, resolution) {
    .Call('_fmrireg_neural_input_rcpp', PACKAGE = 'fmrireg', x, from, to, resolution)
}

evaluate_regressor_convolution <- function(grid, onsets, durations, amplitudes, hrf_values, hrf_span, start, end, precision) {
    .Call('_fmrireg_evaluate_regressor_convolution', PACKAGE = 'fmrireg', grid, onsets, durations, amplitudes, hrf_values, hrf_span, start, end, precision)
}

evaluate_regressor_fast <- function(grid, onsets, durations, amplitudes, hrfFine, dt, span) {
    .Call('_fmrireg_evaluate_regressor_fast', PACKAGE = 'fmrireg', grid, onsets, durations, amplitudes, hrfFine, dt, span)
}

evaluate_regressor_cpp <- function(grid, onsets, durations, amplitudes, hrf_matrix, hrf_span, precision, method = "fft") {
    .Call('_fmrireg_evaluate_regressor_cpp', PACKAGE = 'fmrireg', grid, onsets, durations, amplitudes, hrf_matrix, hrf_span, precision, method)
}

