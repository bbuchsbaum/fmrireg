{"id":"manual.fmrireg.fit_glm","q":"How do I fit a voxelwise GLM to fMRI data?","a":"Use fmrireg::fmri_lm() with a formula specifying event regressors convolved with an HRF, a block variable identifying runs, and a dataset object. It returns per-voxel coefficient estimates, t-statistics, and residuals.","recipe":"sframe <- fmrireg::sampling_frame(blocklens = 200, TR = 2)\ndset <- fmrireg::matrix_dataset(Y, run_length = 200, TR = 2)\nfit <- fmrireg::fmri_lm(onset ~ hrf(condition), block = ~ run,\n                        dataset = dset, data = events)","symbols":["fmrireg::fmri_lm","fmrireg::matrix_dataset","fmrireg::sampling_frame"],"tags":["glm","voxelwise","fitting"]}
{"id":"manual.fmrireg.robust_glm","q":"How do I fit a robust GLM to handle motion artifacts?","a":"Use fmrireg::fmri_rlm() instead of fmri_lm(). It uses iteratively reweighted least squares via robustbase, downweighting outlier timepoints caused by head motion or signal spikes.","recipe":"fit <- fmrireg::fmri_rlm(onset ~ hrf(condition), block = ~ run,\n                         dataset = dset, data = events,\n                         strategy = \"runwise\")","symbols":["fmrireg::fmri_rlm"],"tags":["robust","glm","motion","artifacts"]}
{"id":"manual.fmrireg.event_model","q":"How do I build an event model with multiple conditions?","a":"Use fmrireg::event_model() with a formula that wraps condition factors in hrf(). Supports multiple terms, interactions, and parametric modulators. The model convolves events with the canonical HRF to produce a design matrix.","recipe":"sframe <- fmrireg::sampling_frame(blocklens = c(200, 200), TR = 2)\nemod <- fmrireg::event_model(onset ~ hrf(category, attention),\n                             block = ~ run, data = events,\n                             sampling_frame = sframe)\nfmrireg::design_matrix(emod)","symbols":["fmrireg::event_model","fmrireg::sampling_frame","fmrireg::design_matrix"],"tags":["design","events","hrf","model"]}
{"id":"manual.fmrireg.create_fmri_model","q":"How do I create a full fMRI model with baseline and events?","a":"Use fmrireg::fmri_model() to combine an event model with a baseline model. The baseline captures drift and nuisance regressors; the event model captures experimental conditions. Together they form the complete GLM design.","recipe":"sframe <- fmrireg::sampling_frame(blocklens = 200, TR = 2)\nemod <- fmrireg::event_model(onset ~ hrf(condition),\n                             block = ~ run, data = events,\n                             sampling_frame = sframe)\nbmod <- fmrireg::baseline_model(basis = \"bs\", degree = 5,\n                                sframe = sframe)\nfmod <- fmrireg::fmri_model(emod, bmod)","symbols":["fmrireg::fmri_model","fmrireg::event_model","fmrireg::baseline_model","fmrireg::sampling_frame"],"tags":["model","baseline","design","drift"]}
{"id":"manual.fmrireg.pair_contrast","q":"How do I compute a contrast between two conditions?","a":"Use fmrireg::pair_contrast() to define a sum-to-zero contrast, then pass it to fmrireg::contrast() on the fitted model. Returns t-statistics and p-values for the linear combination of estimated betas.","recipe":"con <- fmrireg::pair_contrast(~ condition == \"face\",\n                              ~ condition == \"scene\",\n                              name = \"face_vs_scene\")\nresult <- fmrireg::contrast(fit, con)","symbols":["fmrireg::pair_contrast","fmrireg::contrast"],"tags":["contrast","hypothesis","pairwise"]}
{"id":"manual.fmrireg.fcontrasts","q":"How do I run an F-test across multiple conditions?","a":"Use fmrireg::Fcontrasts() to bundle several pair_contrast objects into a joint F-test. This tests whether any of the specified contrasts are significantly different from zero.","recipe":"c1 <- fmrireg::pair_contrast(~ condition == \"A\", ~ condition == \"B\", name = \"A_vs_B\")\nc2 <- fmrireg::pair_contrast(~ condition == \"A\", ~ condition == \"C\", name = \"A_vs_C\")\nfcon <- fmrireg::Fcontrasts(c1, c2, name = \"omnibus\")\nresult <- fmrireg::contrast(fit, fcon)","symbols":["fmrireg::Fcontrasts","fmrireg::pair_contrast","fmrireg::contrast"],"tags":["ftest","omnibus","contrast"]}
{"id":"manual.fmrireg.group_meta","q":"How do I run a group-level meta-analysis across subjects?","a":"Use fmrireg::group_data_from_csv() to assemble subject-level betas and standard errors, then fmrireg::fmri_meta() to fit fixed- or random-effects meta-regression with optional covariates like group membership.","recipe":"gd <- fmrireg::group_data_from_csv(df,\n  effect_cols = c(beta = \"beta\", se = \"se\"),\n  subject_col = \"subject\", roi_col = \"roi\",\n  covariate_cols = c(\"group\"))\nfit <- fmrireg::fmri_meta(gd, formula = ~ 1 + group,\n                          method = \"pm\", verbose = FALSE)\nsummary(fit)","symbols":["fmrireg::fmri_meta","fmrireg::group_data_from_csv"],"tags":["group","meta-analysis","random-effects"]}
{"id":"manual.fmrireg.estimate_betas","q":"How do I estimate single-trial betas for MVPA?","a":"Use fmrireg::estimate_betas() on a dataset with a trialwise model. It fits per-trial regressors using least-squares-separate (LSS) or least-squares-all (LSA) approaches, returning a beta map per trial suitable for multivariate pattern analysis.","recipe":"dset <- fmrireg::matrix_dataset(Y, run_length = 200, TR = 2)\nbetas <- fmrireg::estimate_betas(dset,\n  onset ~ trialwise(condition),\n  block = ~ run, data = events,\n  method = \"lss\")","symbols":["fmrireg::estimate_betas","fmrireg::matrix_dataset"],"tags":["mvpa","trialwise","lss","beta"]}
{"id":"manual.fmrireg.fmri_dataset","q":"How do I create a dataset from in-memory fMRI volumes?","a":"Use fmrireg::fmri_mem_dataset() with a list of NeuroVec objects (one per run) and a brain mask. For matrix data use fmrireg::matrix_dataset(). Both produce dataset objects compatible with fmri_lm() and estimate_betas().","recipe":"dset_vol <- fmrireg::fmri_mem_dataset(\n  scans = list(scan_run1, scan_run2),\n  mask = brain_mask, TR = 2)\n\ndset_mat <- fmrireg::matrix_dataset(\n  datamat, run_length = c(200, 200), TR = 2)","symbols":["fmrireg::fmri_mem_dataset","fmrireg::matrix_dataset","fmrireg::fmri_dataset"],"tags":["dataset","input","neuroim2"]}
{"id":"manual.fmrireg.ar_whitening","q":"How do I fit a GLM with AR(1) temporal autocorrelation correction?","a":"Pass cor_struct = \"ar1\" to fmrireg::fmri_lm(). This estimates voxelwise AR parameters and pre-whitens the data before re-fitting the GLM, producing valid standard errors and t-statistics.","recipe":"fit <- fmrireg::fmri_lm(onset ~ hrf(condition),\n  block = ~ run, dataset = dset, data = events,\n  cor_struct = \"ar1\", cor_iter = 2L)","symbols":["fmrireg::fmri_lm"],"tags":["ar1","autocorrelation","whitening","glm"]}
