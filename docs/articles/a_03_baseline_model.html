<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baseline Model • fmrireg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Baseline Model">
<meta property="og:description" content="fmrireg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmrireg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a_01_hemodynamic_response.html">Hemodynamic Response Functions</a>
    </li>
    <li>
      <a href="../articles/a_02_regressor.html">Building Regressors</a>
    </li>
    <li>
      <a href="../articles/a_03_baseline_model.html">Baseline Model</a>
    </li>
    <li>
      <a href="../articles/a_04_event_models.html">Event Models</a>
    </li>
    <li>
      <a href="../articles/a_05_contrasts.html">Contrasts</a>
    </li>
    <li>
      <a href="../articles/a_06_afni.html">Translating to AFNI 3dDeconvolve</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bbuchsbaum/fmrireg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a_03_baseline_model_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Baseline Model</h1>
                        <h4 class="author">Bradley R. Buchsbaum</h4>
            
            <h4 class="date">2020-09-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmrireg/blob/master/vignettes/a_03_baseline_model.Rmd"><code>vignettes/a_03_baseline_model.Rmd</code></a></small>
      <div class="hidden name"><code>a_03_baseline_model.Rmd</code></div>

    </div>

    
    
<div id="fmri-baseline-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fmri-baseline-model" class="anchor"></a>fMRI Baseline Model</h2>
<p>An “baseline model” refers to the set of regressors used to capture variance associated with noise signals in the fMRI time-series data. These regressors are not formed by convolving a hemodynamic response with event onsets, but rather directly model sources of variance in the data. Low-frequency baseline trends are often modeled with a set of basis functions, such as b-splines, polynomial regressors, or a Fourier basis. Nuisance trends can also be derived from the data itself, for example, the global signal mean, motion parameters, or estimated noise components via PCA or ICA.</p>
</div>
<div id="basic-baseline-model-with-b-splines-and-polynomials" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-baseline-model-with-b-splines-and-polynomials" class="anchor"></a>Basic baseline model with b-splines and polynomials</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="kw">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span>(blocklens=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,<span class="fl">100</span>), <span class="kw">TR</span>)
<span class="kw">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span>(basis=<span class="st">"bs"</span>, degree=<span class="fl">5</span>, sframe=<span class="kw">sframe</span>)
</pre></div>
<pre><code>## [1] "baseline_bs_5 : matrix"</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw">bmodel</span>)
</pre></div>
<pre><code>## baseline_model 
##    name:  baseline_bs_5 
##    basis type:  bs 
##    degree:  5 
##    drift columns:  10 
##    constant columns:  2 
##    nuisance columns:  0 
##    total columns:  12 
##    design_matrix:  
## # A tibble: 200 x 12
##    constant_1 constant_2 base_bs1_block_1 base_bs2_block_1 base_bs3_block_1
##         &lt;dbl&gt;      &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1          1          0           0              0               0        
##  2          1          0           0.0485         0.000990        0.0000101
##  3          1          0           0.0931         0.00384         0.0000792
##  4          1          0           0.134          0.00837         0.000262 
##  5          1          0           0.171          0.0144          0.000607 
##  6          1          0           0.205          0.0218          0.00116  
##  7          1          0           0.236          0.0304          0.00196  
##  8          1          0           0.264          0.0401          0.00305  
##  9          1          0           0.288          0.0507          0.00446  
## 10          1          0           0.310          0.0621          0.00621  
## # … with 190 more rows, and 7 more variables: base_bs4_block_1 &lt;dbl&gt;,
## #   base_bs5_block_1 &lt;dbl&gt;, base_bs1_block_2 &lt;dbl&gt;, base_bs2_block_2 &lt;dbl&gt;,
## #   base_bs3_block_2 &lt;dbl&gt;, base_bs4_block_2 &lt;dbl&gt;, base_bs5_block_2 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">bmodel</span>)
</pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">bmodel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span>(basis=<span class="st">"poly"</span>, degree=<span class="fl">5</span>, sframe=<span class="kw">sframe</span>)
</pre></div>
<pre><code>## [1] "baseline_poly_5 : matrix"</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">bmodel2</span>)
</pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
<div id="adding-arbitrary-nuisance-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-arbitrary-nuisance-regressors" class="anchor"></a>Adding arbitrary nuisance regressors</h2>
<p>In addition to structured basis sets, we can also add arbitrary signals to the baseline model. Such signals are also organized by block on the assumption that nuisance signals are often block-specific and “reset” across scans. To add a set of nusiance variables to the baseline model, then, they should be split by block and placed in a <code>list</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="kw">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span>(blocklens=<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">100</span>,<span class="fl">100</span>), <span class="kw">TR</span>)

<span class="co">## generate two arbitrary nusiance signals.</span>
<span class="kw">nuis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span><span class="op">*</span><span class="fl">2</span>)
<span class="kw">nuis2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">100</span><span class="op">*</span><span class="fl">2</span>)

<span class="co">## construct a set of data.frames, each with two columns (nuis1 and nuis2)</span>
<span class="kw">nuislist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="kw">nuis1</span>, <span class="kw">nuis2</span>)), <span class="fu"><a href="../reference/blockids.html">blockids</a></span>(<span class="kw">sframe</span>))

<span class="kw">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span>(basis=<span class="st">"bs"</span>, degree=<span class="fl">5</span>, sframe=<span class="kw">sframe</span>, nuisance_list=<span class="kw">nuislist</span>)
</pre></div>
<pre><code>## [1] "baseline_bs_5 : matrix"
## [1] "nuisance : matrix"</code></pre>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span>(<span class="kw">bmodel</span>))
</pre></div>
<pre><code>## $constant
## fmri_term:  block_term 
##    Term Name:  constant 
##    Num Rows:  200 
##    Num Columns:  2 
## 
## $baseline_bs_5
## fmri_term:  baseline_term 
##    Term Name:  baseline_bs_5 
##    Num Rows:  200 
##    Num Columns:  10 
## 
## $nuisance
## fmri_term:  baseline_term 
##    Term Name:  nuisance 
##    Num Rows:  200 
##    Num Columns:  4</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw">bmodel</span>, term_name=<span class="st">"nuisance"</span>)
</pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bradley Buchsbaum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
