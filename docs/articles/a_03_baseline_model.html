<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fmrireg">
<title>Baseline Model • fmrireg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Baseline Model">
<meta property="og:description" content="fmrireg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fmrireg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Overview.html">Overview</a>
    <a class="dropdown-item" href="../articles/a_01_hemodynamic_response.html">Hemodynamic Response Functions</a>
    <a class="dropdown-item" href="../articles/a_02_regressor.html">Building Regressors</a>
    <a class="dropdown-item" href="../articles/a_03_baseline_model.html">Baseline Model</a>
    <a class="dropdown-item" href="../articles/a_04_event_models.html">Event Models</a>
    <a class="dropdown-item" href="../articles/a_05_contrasts.html">Contrasts</a>
    <a class="dropdown-item" href="../articles/a_06_afni.html">Translating to AFNI 3dDeconvolve</a>
    <a class="dropdown-item" href="../articles/a_07_trialwise.html">Single Trial Beta Estimation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bbuchsbaum/fmrireg/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Baseline Model</h1>
                        <h4 data-toc-skip class="author">Bradley R.
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2023-05-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmrireg/blob/HEAD/vignettes/a_03_baseline_model.Rmd" class="external-link"><code>vignettes/a_03_baseline_model.Rmd</code></a></small>
      <div class="d-none name"><code>a_03_baseline_model.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="fmri-baseline-model">fMRI Baseline Model<a class="anchor" aria-label="anchor" href="#fmri-baseline-model"></a>
</h2>
<p>An “baseline model” refers to the set of regressors used to capture
variance associated with noise signals in the fMRI time-series data.
These regressors are not formed by convolving a hemodynamic response
with event onsets, but rather directly model sources of variance in the
data. Low-frequency baseline trends are often modeled with a set of
basis functions, such as b-splines, polynomial regressors, or a Fourier
basis. Nuisance trends can also be derived from the data itself, for
example, the global signal mean, motion parameters, or estimated noise
components via PCA or ICA.</p>
</div>
<div class="section level2">
<h2 id="basic-baseline-model-with-b-splines-and-polynomials">Basic baseline model with b-splines and polynomials<a class="anchor" aria-label="anchor" href="#basic-baseline-model-with-b-splines-and-polynomials"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span><span class="op">(</span>blocklens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, <span class="va">TR</span><span class="op">)</span></span>
<span><span class="va">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"bs"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span><span class="op">)</span></span>
<span><span class="va">bmodel</span></span></code></pre></div>
<pre><code><span><span class="co">## baseline_model </span></span>
<span><span class="co">##    name:  baseline_bs_5 </span></span>
<span><span class="co">##    basis type:  bs </span></span>
<span><span class="co">##    degree:  5 </span></span>
<span><span class="co">##    drift columns:  10 </span></span>
<span><span class="co">##    constant columns:  2 </span></span>
<span><span class="co">##    nuisance columns:  0 </span></span>
<span><span class="co">##    total columns:  12 </span></span>
<span><span class="co">##    design_matrix:  </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 12</span></span></span>
<span><span class="co">##    constant_1 constant_2 base_bs1_block_1 base_bs2_block_1 base_bs3_block_1</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>          1          0           0              0               0        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>          1          0           0.048<span style="text-decoration: underline;">5</span>         0.000<span style="text-decoration: underline;">990</span>        0.000<span style="text-decoration: underline;">010</span>1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>          1          0           0.093<span style="text-decoration: underline;">1</span>         0.003<span style="text-decoration: underline;">84</span>         0.000<span style="text-decoration: underline;">079</span>2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>          1          0           0.134          0.008<span style="text-decoration: underline;">37</span>         0.000<span style="text-decoration: underline;">262</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>          1          0           0.171          0.014<span style="text-decoration: underline;">4</span>          0.000<span style="text-decoration: underline;">607</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>          1          0           0.205          0.021<span style="text-decoration: underline;">8</span>          0.001<span style="text-decoration: underline;">16</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>          1          0           0.236          0.030<span style="text-decoration: underline;">4</span>          0.001<span style="text-decoration: underline;">96</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>          1          0           0.264          0.040<span style="text-decoration: underline;">1</span>          0.003<span style="text-decoration: underline;">05</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>          1          0           0.288          0.050<span style="text-decoration: underline;">7</span>          0.004<span style="text-decoration: underline;">46</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          1          0           0.310          0.062<span style="text-decoration: underline;">1</span>          0.006<span style="text-decoration: underline;">21</span>  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 190 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 7 more variables: base_bs4_block_1 &lt;dbl&gt;, base_bs5_block_1 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   base_bs1_block_2 &lt;dbl&gt;, base_bs2_block_2 &lt;dbl&gt;, base_bs3_block_2 &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   base_bs4_block_2 &lt;dbl&gt;, base_bs5_block_2 &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmodel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"poly"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel2</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="adding-arbitrary-nuisance-regressors">Adding arbitrary nuisance regressors<a class="anchor" aria-label="anchor" href="#adding-arbitrary-nuisance-regressors"></a>
</h2>
<p>In addition to structured basis sets, we can also add arbitrary
signals to the baseline model. Such signals are also organized by block
on the assumption that nuisance signals are often block-specific and
“reset” across scans. To add a set of nusiance variables to the baseline
model, then, they should be split by block and placed in a
<code>list</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span><span class="op">(</span>blocklens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, <span class="va">TR</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## generate two arbitrary nusiance signals.</span></span>
<span><span class="va">nuis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">nuis2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## construct a set of data.frames, each with two columns (nuis1 and nuis2)</span></span>
<span><span class="va">nuislist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nuis1</span>, <span class="va">nuis2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/blockids.html">blockids</a></span><span class="op">(</span><span class="va">sframe</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"bs"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span>, nuisance_list<span class="op">=</span><span class="va">nuislist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></span><span class="op">(</span><span class="va">bmodel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $constant</span></span>
<span><span class="co">## fmri_term:  block_term </span></span>
<span><span class="co">##    Term Name:  constant </span></span>
<span><span class="co">##    Num Rows:  200 </span></span>
<span><span class="co">##    Num Columns:  2 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $baseline_bs_5</span></span>
<span><span class="co">## fmri_term:  baseline_term </span></span>
<span><span class="co">##    Term Name:  baseline_bs_5 </span></span>
<span><span class="co">##    Num Rows:  200 </span></span>
<span><span class="co">##    Num Columns:  10 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nuisance</span></span>
<span><span class="co">## fmri_term:  baseline_term </span></span>
<span><span class="co">##    Term Name:  nuisance </span></span>
<span><span class="co">##    Num Rows:  200 </span></span>
<span><span class="co">##    Num Columns:  4</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel</span>, term_name<span class="op">=</span><span class="st">"nuisance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://linguamemoria.org" class="external-link">Bradley Buchsbaum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
