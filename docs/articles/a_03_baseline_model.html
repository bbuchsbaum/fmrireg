<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baseline Model • fmrireg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Baseline Model">
<meta property="og:description" content="fmrireg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmrireg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/a_01_hemodynamic_response.html">Hemodynamic Response Functions</a>
    </li>
    <li>
      <a href="../articles/a_02_regressor.html">Building Regressors</a>
    </li>
    <li>
      <a href="../articles/a_03_baseline_model.html">Baseline Model</a>
    </li>
    <li>
      <a href="../articles/a_04_event_models.html">Event Models</a>
    </li>
    <li>
      <a href="../articles/a_05_contrasts.html">Contrasts</a>
    </li>
    <li>
      <a href="../articles/a_06_afni.html">Translating to AFNI 3dDeconvolve</a>
    </li>
    <li>
      <a href="../articles/a_07_trialwise.html">Single Trial Beta Estimation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bbuchsbaum/fmrireg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Baseline Model</h1>
                        <h4 data-toc-skip class="author">Bradley R.
Buchsbaum</h4>
            
            <h4 data-toc-skip class="date">2022-12-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmrireg/blob/HEAD/vignettes/a_03_baseline_model.Rmd" class="external-link"><code>vignettes/a_03_baseline_model.Rmd</code></a></small>
      <div class="hidden name"><code>a_03_baseline_model.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="fmri-baseline-model">fMRI Baseline Model<a class="anchor" aria-label="anchor" href="#fmri-baseline-model"></a>
</h2>
<p>An “baseline model” refers to the set of regressors used to capture
variance associated with noise signals in the fMRI time-series data.
These regressors are not formed by convolving a hemodynamic response
with event onsets, but rather directly model sources of variance in the
data. Low-frequency baseline trends are often modeled with a set of
basis functions, such as b-splines, polynomial regressors, or a Fourier
basis. Nuisance trends can also be derived from the data itself, for
example, the global signal mean, motion parameters, or estimated noise
components via PCA or ICA.</p>
</div>
<div class="section level2">
<h2 id="basic-baseline-model-with-b-splines-and-polynomials">Basic baseline model with b-splines and polynomials<a class="anchor" aria-label="anchor" href="#basic-baseline-model-with-b-splines-and-polynomials"></a>
</h2>
<pre><code><span><span class="co">## Warning: replacing previous import 'Matrix::cov2cor' by 'stats::cov2cor' when</span></span>
<span><span class="co">## loading 'fmrireg'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'Matrix::toeplitz' by 'stats::toeplitz' when</span></span>
<span><span class="co">## loading 'fmrireg'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'Matrix::update' by 'stats::update' when</span></span>
<span><span class="co">## loading 'fmrireg'</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span><span class="op">(</span>blocklens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, <span class="va">TR</span><span class="op">)</span></span>
<span><span class="va">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"bs"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bmodel</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $drift_term</span></span>
<span><span class="co">## $varname</span></span>
<span><span class="co">## [1] "baseline_bs_5"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design_matrix</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 10</span></span></span>
<span><span class="co">##    base_bs1_b…¹ base_…² base_…³ base_…⁴ base_b…⁵ base_…⁶ base_…⁷ base_…⁸ base_…⁹</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       0      0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>          0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>       0.048<span style="text-decoration: underline;">5</span> 9.90<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-8</span> 1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>       0.093<span style="text-decoration: underline;">1</span> 3.84<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 7.92<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 8.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 3.36<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>       0.134  8.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 2.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 4.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span> 2.56<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       0.171  1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 6.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 1.08<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       0.205  2.18<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 1.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.29<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       0.236  3.04<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 1.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 6.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 8.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       0.264  4.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 3.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.77<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       0.288  5.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 3.45<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       0.310  6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 190 more rows, 1 more variable: base_bs5_block_2 &lt;dbl&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​base_bs1_block_1, ²​base_bs2_block_1,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​base_bs3_block_1, ⁴​base_bs4_block_1, ⁵​base_bs5_block_1, ⁶​base_bs1_block_2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁷​base_bs2_block_2, ⁸​base_bs3_block_2, ⁹​base_bs4_block_2</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind</span></span>
<span><span class="co">## $colind[[1]]</span></span>
<span><span class="co">## [1] 1 2 3 4 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind[[2]]</span></span>
<span><span class="co">## [1]  6  7  8  9 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind</span></span>
<span><span class="co">## $rowind[[1]]</span></span>
<span><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span></span>
<span><span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span></span>
<span><span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span></span>
<span><span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span></span>
<span><span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span></span>
<span><span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind[[2]]</span></span>
<span><span class="co">##   [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118</span></span>
<span><span class="co">##  [19] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136</span></span>
<span><span class="co">##  [37] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154</span></span>
<span><span class="co">##  [55] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172</span></span>
<span><span class="co">##  [73] 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190</span></span>
<span><span class="co">##  [91] 191 192 193 194 195 196 197 198 199 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "baseline_term" "matrix_term"   "fmri_term"     "list"         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $drift_spec</span></span>
<span><span class="co">## $degree</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $basis</span></span>
<span><span class="co">## [1] "bs"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $fun</span></span>
<span><span class="co">## function (x, df = NULL, knots = NULL, degree = 3, intercept = FALSE, </span></span>
<span><span class="co">##     Boundary.knots = range(x)) </span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##     ord &lt;- 1L + (degree &lt;- as.integer(degree))</span></span>
<span><span class="co">##     if (ord &lt;= 1) </span></span>
<span><span class="co">##         stop("'degree' must be integer &gt;= 1")</span></span>
<span><span class="co">##     nx &lt;- names(x)</span></span>
<span><span class="co">##     x &lt;- as.vector(x)</span></span>
<span><span class="co">##     nax &lt;- is.na(x)</span></span>
<span><span class="co">##     if (nas &lt;- any(nax)) </span></span>
<span><span class="co">##         x &lt;- x[!nax]</span></span>
<span><span class="co">##     outside &lt;- if (!missing(Boundary.knots)) {</span></span>
<span><span class="co">##         Boundary.knots &lt;- sort(Boundary.knots)</span></span>
<span><span class="co">##         (ol &lt;- x &lt; Boundary.knots[1L]) | (or &lt;- x &gt; Boundary.knots[2L])</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else FALSE</span></span>
<span><span class="co">##     if (!is.null(df) &amp;&amp; is.null(knots)) {</span></span>
<span><span class="co">##         nIknots &lt;- df - ord + (1L - intercept)</span></span>
<span><span class="co">##         if (nIknots &lt; 0L) {</span></span>
<span><span class="co">##             nIknots &lt;- 0L</span></span>
<span><span class="co">##             warning(gettextf("'df' was too small; have used %d", </span></span>
<span><span class="co">##                 ord - (1L - intercept)), domain = NA)</span></span>
<span><span class="co">##         }</span></span>
<span><span class="co">##         knots &lt;- if (nIknots &gt; 0L) {</span></span>
<span><span class="co">##             knots &lt;- seq.int(from = 0, to = 1, length.out = nIknots + </span></span>
<span><span class="co">##                 2L)[-c(1L, nIknots + 2L)]</span></span>
<span><span class="co">##             quantile(x[!outside], knots)</span></span>
<span><span class="co">##         }</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     Aknots &lt;- sort(c(rep(Boundary.knots, ord), knots))</span></span>
<span><span class="co">##     if (any(outside)) {</span></span>
<span><span class="co">##         warning("some 'x' values beyond boundary knots may cause ill-conditioned bases")</span></span>
<span><span class="co">##         derivs &lt;- 0:degree</span></span>
<span><span class="co">##         scalef &lt;- gamma(1L:ord)</span></span>
<span><span class="co">##         basis &lt;- array(0, c(length(x), length(Aknots) - degree - </span></span>
<span><span class="co">##             1L))</span></span>
<span><span class="co">##         e &lt;- 1/4</span></span>
<span><span class="co">##         if (any(ol)) {</span></span>
<span><span class="co">##             k.pivot &lt;- (1 - e) * Boundary.knots[1L] + e * Aknots[ord + </span></span>
<span><span class="co">##                 1]</span></span>
<span><span class="co">##             xl &lt;- cbind(1, outer(x[ol] - k.pivot, 1L:degree, </span></span>
<span><span class="co">##                 `^`))</span></span>
<span><span class="co">##             tt &lt;- splineDesign(Aknots, rep(k.pivot, ord), ord, </span></span>
<span><span class="co">##                 derivs)</span></span>
<span><span class="co">##             basis[ol, ] &lt;- xl %*% (tt/scalef)</span></span>
<span><span class="co">##         }</span></span>
<span><span class="co">##         if (any(or)) {</span></span>
<span><span class="co">##             k.pivot &lt;- (1 - e) * Boundary.knots[2L] + e * Aknots[length(Aknots) - </span></span>
<span><span class="co">##                 ord]</span></span>
<span><span class="co">##             xr &lt;- cbind(1, outer(x[or] - k.pivot, 1L:degree, </span></span>
<span><span class="co">##                 `^`))</span></span>
<span><span class="co">##             tt &lt;- splineDesign(Aknots, rep(k.pivot, ord), ord, </span></span>
<span><span class="co">##                 derivs)</span></span>
<span><span class="co">##             basis[or, ] &lt;- xr %*% (tt/scalef)</span></span>
<span><span class="co">##         }</span></span>
<span><span class="co">##         if (any(inside &lt;- !outside)) </span></span>
<span><span class="co">##             basis[inside, ] &lt;- splineDesign(Aknots, x[inside], </span></span>
<span><span class="co">##                 ord)</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     else basis &lt;- splineDesign(Aknots, x, ord)</span></span>
<span><span class="co">##     if (!intercept) </span></span>
<span><span class="co">##         basis &lt;- basis[, -1L, drop = FALSE]</span></span>
<span><span class="co">##     n.col &lt;- ncol(basis)</span></span>
<span><span class="co">##     if (nas) {</span></span>
<span><span class="co">##         nmat &lt;- matrix(NA, length(nax), n.col)</span></span>
<span><span class="co">##         nmat[!nax, ] &lt;- basis</span></span>
<span><span class="co">##         basis &lt;- nmat</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     dimnames(basis) &lt;- list(nx, 1L:n.col)</span></span>
<span><span class="co">##     a &lt;- list(degree = degree, knots = if (is.null(knots)) numeric(0L) else knots, </span></span>
<span><span class="co">##         Boundary.knots = Boundary.knots, intercept = intercept)</span></span>
<span><span class="co">##     attributes(basis) &lt;- c(attributes(basis), a)</span></span>
<span><span class="co">##     class(basis) &lt;- c("bs", "basis", "matrix")</span></span>
<span><span class="co">##     basis</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## &lt;bytecode: 0x7fa192bc1380&gt;</span></span>
<span><span class="co">## &lt;environment: namespace:splines&gt;</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $intercept</span></span>
<span><span class="co">## [1] "runwise"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $name</span></span>
<span><span class="co">## [1] "baseline_bs_5"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "baselinespec" "nuisancespec"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $block_term</span></span>
<span><span class="co">## $varname</span></span>
<span><span class="co">## [1] "constant"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $blockids</span></span>
<span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $expanded_blockids</span></span>
<span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## Levels: 1 &lt; 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design_matrix</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 2</span></span></span>
<span><span class="co">##    constant_1 constant_2</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          1          0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 190 more rows</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nblocks</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind</span></span>
<span><span class="co">## $colind[[1]]</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind[[2]]</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind</span></span>
<span><span class="co">## $rowind$`1`</span></span>
<span><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span></span>
<span><span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span></span>
<span><span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span></span>
<span><span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span></span>
<span><span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span></span>
<span><span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind$`2`</span></span>
<span><span class="co">##   [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118</span></span>
<span><span class="co">##  [19] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136</span></span>
<span><span class="co">##  [37] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154</span></span>
<span><span class="co">##  [55] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172</span></span>
<span><span class="co">##  [73] 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190</span></span>
<span><span class="co">##  [91] 191 192 193 194 195 196 197 198 199 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "block_term"  "matrix_term" "fmri_term"   "list"       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nuisance_term</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sampling_frame</span></span>
<span><span class="co">## $blocklens</span></span>
<span><span class="co">## [1] 100 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $TR</span></span>
<span><span class="co">## [1] 2 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $start_time</span></span>
<span><span class="co">## [1] 1 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $blockids</span></span>
<span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $time</span></span>
<span><span class="co">##   [1]   1   3   5   7   9  11  13  15  17  19  21  23  25  27  29  31  33  35</span></span>
<span><span class="co">##  [19]  37  39  41  43  45  47  49  51  53  55  57  59  61  63  65  67  69  71</span></span>
<span><span class="co">##  [37]  73  75  77  79  81  83  85  87  89  91  93  95  97  99 101 103 105 107</span></span>
<span><span class="co">##  [55] 109 111 113 115 117 119 121 123 125 127 129 131 133 135 137 139 141 143</span></span>
<span><span class="co">##  [73] 145 147 149 151 153 155 157 159 161 163 165 167 169 171 173 175 177 179</span></span>
<span><span class="co">##  [91] 181 183 185 187 189 191 193 195 197 199   1   3   5   7   9  11  13  15</span></span>
<span><span class="co">## [109]  17  19  21  23  25  27  29  31  33  35  37  39  41  43  45  47  49  51</span></span>
<span><span class="co">## [127]  53  55  57  59  61  63  65  67  69  71  73  75  77  79  81  83  85  87</span></span>
<span><span class="co">## [145]  89  91  93  95  97  99 101 103 105 107 109 111 113 115 117 119 121 123</span></span>
<span><span class="co">## [163] 125 127 129 131 133 135 137 139 141 143 145 147 149 151 153 155 157 159</span></span>
<span><span class="co">## [181] 161 163 165 167 169 171 173 175 177 179 181 183 185 187 189 191 193 195</span></span>
<span><span class="co">## [199] 197 199</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $precision</span></span>
<span><span class="co">## [1] 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "sampling_frame" "list"          </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "baseline_model" "list"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmodel2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"poly"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel2</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="adding-arbitrary-nuisance-regressors">Adding arbitrary nuisance regressors<a class="anchor" aria-label="anchor" href="#adding-arbitrary-nuisance-regressors"></a>
</h2>
<p>In addition to structured basis sets, we can also add arbitrary
signals to the baseline model. Such signals are also organized by block
on the assumption that nuisance signals are often block-specific and
“reset” across scans. To add a set of nusiance variables to the baseline
model, then, they should be split by block and placed in a
<code>list</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TR</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">sframe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampling_frame.html">sampling_frame</a></span><span class="op">(</span>blocklens<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span>, <span class="va">TR</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## generate two arbitrary nusiance signals.</span></span>
<span><span class="va">nuis1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">nuis2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## construct a set of data.frames, each with two columns (nuis1 and nuis2)</span></span>
<span><span class="va">nuislist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">nuis1</span>, <span class="va">nuis2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/blockids.html">blockids</a></span><span class="op">(</span><span class="va">sframe</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bmodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/baseline_model.html">baseline_model</a></span><span class="op">(</span>basis<span class="op">=</span><span class="st">"bs"</span>, degree<span class="op">=</span><span class="fl">5</span>, sframe<span class="op">=</span><span class="va">sframe</span>, nuisance_list<span class="op">=</span><span class="va">nuislist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms</a></span><span class="op">(</span><span class="va">bmodel</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $constant</span></span>
<span><span class="co">## $varname</span></span>
<span><span class="co">## [1] "constant"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $blockids</span></span>
<span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $expanded_blockids</span></span>
<span><span class="co">##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [112] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</span></span>
<span><span class="co">## Levels: 1 &lt; 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design_matrix</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 2</span></span></span>
<span><span class="co">##    constant_1 constant_2</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>          1          0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>          1          0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 190 more rows</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nblocks</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind</span></span>
<span><span class="co">## $colind[[1]]</span></span>
<span><span class="co">## [1] 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind[[2]]</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind</span></span>
<span><span class="co">## $rowind$`1`</span></span>
<span><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span></span>
<span><span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span></span>
<span><span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span></span>
<span><span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span></span>
<span><span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span></span>
<span><span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind$`2`</span></span>
<span><span class="co">##   [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118</span></span>
<span><span class="co">##  [19] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136</span></span>
<span><span class="co">##  [37] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154</span></span>
<span><span class="co">##  [55] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172</span></span>
<span><span class="co">##  [73] 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190</span></span>
<span><span class="co">##  [91] 191 192 193 194 195 196 197 198 199 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "block_term"  "matrix_term" "fmri_term"   "list"       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $baseline_bs_5</span></span>
<span><span class="co">## $varname</span></span>
<span><span class="co">## [1] "baseline_bs_5"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design_matrix</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 10</span></span></span>
<span><span class="co">##    base_bs1_b…¹ base_…² base_…³ base_…⁴ base_b…⁵ base_…⁶ base_…⁷ base_…⁸ base_…⁹</span></span>
<span><span class="co">##           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       0      0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>   0   <span style="color: #949494;"> </span>          0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>       0.048<span style="text-decoration: underline;">5</span> 9.90<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 5.15<span style="color: #949494;">e</span><span style="color: #BB0000;">-8</span> 1.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-10</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>       0.093<span style="text-decoration: underline;">1</span> 3.84<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 7.92<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 8.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-7</span> 3.36<span style="color: #949494;">e</span><span style="color: #BB0000;">- 9</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>       0.134  8.37<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 2.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 4.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span> 2.56<span style="color: #949494;">e</span><span style="color: #BB0000;">- 8</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       0.171  1.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 6.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 1.08<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       0.205  2.18<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 1.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.09<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 3.29<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       0.236  3.04<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 1.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 6.34<span style="color: #949494;">e</span><span style="color: #BB0000;">-5</span> 8.18<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       0.264  4.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 3.05<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 1.77<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       0.288  5.07<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 1.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 3.45<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       0.310  6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.10<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 6.21<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>       0       0       0       0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 190 more rows, 1 more variable: base_bs5_block_2 &lt;dbl&gt;, and</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   abbreviated variable names ¹​base_bs1_block_1, ²​base_bs2_block_1,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ³​base_bs3_block_1, ⁴​base_bs4_block_1, ⁵​base_bs5_block_1, ⁶​base_bs1_block_2,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ⁷​base_bs2_block_2, ⁸​base_bs3_block_2, ⁹​base_bs4_block_2</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind</span></span>
<span><span class="co">## $colind[[1]]</span></span>
<span><span class="co">## [1] 1 2 3 4 5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind[[2]]</span></span>
<span><span class="co">## [1]  6  7  8  9 10</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind</span></span>
<span><span class="co">## $rowind[[1]]</span></span>
<span><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span></span>
<span><span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span></span>
<span><span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span></span>
<span><span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span></span>
<span><span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span></span>
<span><span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind[[2]]</span></span>
<span><span class="co">##   [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118</span></span>
<span><span class="co">##  [19] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136</span></span>
<span><span class="co">##  [37] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154</span></span>
<span><span class="co">##  [55] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172</span></span>
<span><span class="co">##  [73] 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190</span></span>
<span><span class="co">##  [91] 191 192 193 194 195 196 197 198 199 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "baseline_term" "matrix_term"   "fmri_term"     "list"         </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nuisance</span></span>
<span><span class="co">## $varname</span></span>
<span><span class="co">## [1] "nuisance"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $design_matrix</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 200 × 4</span></span></span>
<span><span class="co">##    `nuisance#1#1` `nuisance#1#2` `nuisance#2#1` `nuisance#2#2`</span></span>
<span><span class="co">##             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1.84            -<span style="color: #BB0000;">1.98</span>               0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        0.786            0.878              0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        1.21             0.803              0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        0.018<span style="text-decoration: underline;">4</span>           0.162              0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       -<span style="color: #BB0000;">0.008</span><span style="color: #BB0000; text-decoration: underline;">33</span>         -<span style="color: #BB0000;">0.677</span>              0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       -<span style="color: #BB0000;">0.415</span>            0.850              0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        0.138            1.33               0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       -<span style="color: #BB0000;">2.69</span>            -<span style="color: #BB0000;">2.09</span>               0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        0.215            2.40               0              0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>        0.217           -<span style="color: #BB0000;">1.49</span>               0              0</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 190 more rows</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind</span></span>
<span><span class="co">## $colind[[1]]</span></span>
<span><span class="co">## [1] 1 2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $colind[[2]]</span></span>
<span><span class="co">## [1] 3 4</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind</span></span>
<span><span class="co">## $rowind$`1`</span></span>
<span><span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span></span>
<span><span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span></span>
<span><span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span></span>
<span><span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span></span>
<span><span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span></span>
<span><span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $rowind$`2`</span></span>
<span><span class="co">##   [1] 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118</span></span>
<span><span class="co">##  [19] 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136</span></span>
<span><span class="co">##  [37] 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154</span></span>
<span><span class="co">##  [55] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172</span></span>
<span><span class="co">##  [73] 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190</span></span>
<span><span class="co">##  [91] 191 192 193 194 195 196 197 198 199 200</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "baseline_term" "matrix_term"   "fmri_term"     "list"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bmodel</span>, term_name<span class="op">=</span><span class="st">"nuisance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a_03_baseline_model_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://linguamemoria.org" class="external-link">Bradley Buchsbaum</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
