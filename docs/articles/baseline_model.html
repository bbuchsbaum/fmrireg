<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baseline Model • fmrireg</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">fmrireg</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/baseline_model.html">Baseline Model</a>
    </li>
    <li>
      <a href="../articles/contrasts.html">Contrastsl</a>
    </li>
    <li>
      <a href="../articles/event_models.html">Event Models</a>
    </li>
    <li>
      <a href="../articles/hemodynamic_response.html">Hemodynamic Response Functions</a>
    </li>
    <li>
      <a href="../articles/regressor.html">Building Regressors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bbuchsbaum/fmrireg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Baseline Model</h1>
                        <h4 class="author">Bradley R. Buchsbaum</h4>
            
            <h4 class="date">2017-11-27</h4>
          </div>

    
    
<div class="contents">
<div id="fmri-baseline-model" class="section level2">
<h2 class="hasAnchor">
<a href="#fmri-baseline-model" class="anchor"></a>fMRI Baseline Model</h2>
<p>An “baseline model” refers to the set of regressors used to capture variance associated with noise signals in the fMRI time-series data. These regressors are not formed by convolving a hemodynamic response with event onsets, but rather directly model sources of variance in the data. Low-frequency baseline trends are often modeled with a set of basis functions, such as b-splines, polynomial regressors, or a Fourier basis. Nuisance trends can also be derived from the data itself, for example, the global signal mean, motion parameters, or estimated noise components via PCA or ICA.</p>
</div>
<div id="basic-baseline-model-with-b-splines-and-polynomials" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-baseline-model-with-b-splines-and-polynomials" class="anchor"></a>Basic baseline model with b-splines and polynomials</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TR &lt;-<span class="st"> </span><span class="dv">2</span>
sframe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampling_frame.html">sampling_frame</a></span>(<span class="dt">blocklens=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">100</span>), TR)
bmodel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/baseline_model.html">baseline_model</a></span>(<span class="dt">basis=</span><span class="st">"bs"</span>, <span class="dt">degree=</span><span class="dv">5</span>, <span class="dt">sframe=</span>sframe)
<span class="kw">print</span>(bmodel)</code></pre></div>
<pre><code>## baseline_model 
##    name:  baseline_bs_5 
##    basis type:  bs 
##    degree:  5 
##    drift columns:  10 
##    constant columns:  2 
##    nuisance columns:  0 
##    total columns:  12 
##    design_matrix:  
## # A tibble: 200 x 12
##    const… cons… base_… base_b… base_b… base… base… base… base… base… base…
##     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   1.00     0 0      0       0           0     0     0     0     0     0
##  2   1.00     0 0.0868 0.00135 4.64e⁻⁶     0     0     0     0     0     0
##  3   1.00     0 0.166  0.00531 3.71e⁻⁵     0     0     0     0     0     0
##  4   1.00     0 0.237  0.0117  1.25e⁻⁴     0     0     0     0     0     0
##  5   1.00     0 0.301  0.0204  2.97e⁻⁴     0     0     0     0     0     0
##  6   1.00     0 0.357  0.0312  5.80e⁻⁴     0     0     0     0     0     0
##  7   1.00     0 0.407  0.0441  1.00e⁻³     0     0     0     0     0     0
##  8   1.00     0 0.451  0.0587  1.59e⁻³     0     0     0     0     0     0
##  9   1.00     0 0.488  0.0751  2.37e⁻³     0     0     0     0     0     0
## 10   1.00     0 0.519  0.0930  3.38e⁻³     0     0     0     0     0     0
## # ... with 190 more rows, and 1 more variable: base_bs5_block_2 &lt;dbl&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bmodel)</code></pre></div>
<p><img src="baseline_model_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bmodel2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/baseline_model.html">baseline_model</a></span>(<span class="dt">basis=</span><span class="st">"poly"</span>, <span class="dt">degree=</span><span class="dv">5</span>, <span class="dt">sframe=</span>sframe)
<span class="kw">plot</span>(bmodel2)</code></pre></div>
<p><img src="baseline_model_files/figure-html/unnamed-chunk-2-2.png" width="672"></p>
</div>
<div id="adding-arbitrary-nuisance-regressors" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-arbitrary-nuisance-regressors" class="anchor"></a>Adding arbitrary nuisance regressors</h2>
<p>In addiiton to structured basis sets, we can also add arbitrary signals to the baseline model. Such signals are also organized by block on the assumption that nuisance signals are often block-specific and “reset” across scans. To add a set of nusiance variables to the baseline model, then, they should be split by block and placed in a <code>list</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TR &lt;-<span class="st"> </span><span class="dv">2</span>
sframe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sampling_frame.html">sampling_frame</a></span>(<span class="dt">blocklens=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">100</span>), TR)

## generate two arbitrary nusiance signals.
nuis1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span><span class="dv">2</span>)
nuis2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span><span class="op">*</span><span class="dv">2</span>)

## construct a set of data.frames, each with two columns (nuis1 and nuis2)
nuislist &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(nuis1, nuis2)), <span class="kw"><a href="../reference/blockids.html">blockids</a></span>(sframe))

bmodel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/baseline_model.html">baseline_model</a></span>(<span class="dt">basis=</span><span class="st">"bs"</span>, <span class="dt">degree=</span><span class="dv">5</span>, <span class="dt">sframe=</span>sframe, <span class="dt">nuisance_list=</span>nuislist)
<span class="kw">print</span>(<span class="kw">terms</span>(bmodel))</code></pre></div>
<pre><code>## $constant
## fmri_term:  block_term 
##    Term Name:  constant 
##    Num Rows:  200 
##    Num Columns:  2 
## 
## $baseline_bs_5
## fmri_term:  baseline_term 
##    Term Name:  baseline_bs_5 
##    Num Rows:  200 
##    Num Columns:  10 
## 
## $nuisance
## fmri_term:  baseline_term 
##    Term Name:  nuisance 
##    Num Rows:  200 
##    Num Columns:  4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bmodel, <span class="dt">term_name=</span><span class="st">"nuisance"</span>)</code></pre></div>
<p><img src="baseline_model_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bmodel, <span class="dt">term_name=</span><span class="st">"baseline_bs_5"</span>)</code></pre></div>
<p><img src="baseline_model_files/figure-html/unnamed-chunk-3-2.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#fmri-baseline-model">fMRI Baseline Model</a></li>
      <li><a href="#basic-baseline-model-with-b-splines-and-polynomials">Basic baseline model with b-splines and polynomials</a></li>
      <li><a href="#adding-arbitrary-nuisance-regressors">Adding arbitrary nuisance regressors</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bradley R. Buchsbaum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
