<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> • fmrireg</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fmrireg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/Overview.html">Package Overview</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Topics</h6></li>
    <li><a class="dropdown-item" href="../articles/a_05_contrasts.html">Contrasts</a></li>
    <li><a class="dropdown-item" href="../articles/a_08_simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/a_09_linear_model.html">Linear Modeling</a></li>
    <li><a class="dropdown-item" href="../articles/a_10_dataset.html">Dataset Management</a></li>
    <li><a class="dropdown-item" href="../articles/group_analysis.html">Group Analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Resources</h6></li>
    <li><a class="dropdown-item" href="../articles/benchmark_datasets.html">Benchmark Datasets</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/bbuchsbaum/fmrireg/releases/tag/v0.1.0">Version 0.1.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bbuchsbaum/fmrireg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bbuchsbaum/fmrireg/blob/master/vignettes/benchmark_datasets.Rmd" class="external-link"><code>vignettes/benchmark_datasets.Rmd</code></a></small>
      <div class="d-none name"><code>benchmark_datasets.Rmd</code></div>
    </div>

    
    
<p>title: “06. Benchmark Datasets” author: “fmrireg package” date:
“2025-09-01” output: rmarkdown::html_vignette vignette: &gt; % % % —</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>fmrireg</code> package includes a comprehensive set of
benchmark datasets designed for testing and evaluating HRF fitting, beta
estimation, and other fMRI analysis methods. These datasets provide
known ground truth for various challenging scenarios commonly
encountered in fMRI analysis.</p>
<p>This vignette demonstrates how to use these benchmark datasets to
evaluate your analysis methods.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bbuchsbaum.github.io/fmrireg/">fmrireg</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fmrireg'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     convolve</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:fmrireg':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_data</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="available-benchmark-datasets">Available Benchmark Datasets<a class="anchor" aria-label="anchor" href="#available-benchmark-datasets"></a>
</h2>
<p>Let’s start by exploring what benchmark datasets are available:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all available datasets</span></span>
<span><span class="va">datasets_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_benchmark_datasets.html">list_benchmark_datasets</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">datasets_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                                         Dataset</span></span>
<span><span class="co">#&gt; BM_Canonical_HighSNR                       BM_Canonical_HighSNR</span></span>
<span><span class="co">#&gt; BM_Canonical_LowSNR                         BM_Canonical_LowSNR</span></span>
<span><span class="co">#&gt; BM_HRF_Variability_AcrossVoxels BM_HRF_Variability_AcrossVoxels</span></span>
<span><span class="co">#&gt; BM_Trial_Amplitude_Variability   BM_Trial_Amplitude_Variability</span></span>
<span><span class="co">#&gt; BM_Complex_Realistic                       BM_Complex_Realistic</span></span>
<span><span class="co">#&gt;                                                                                                                        Description</span></span>
<span><span class="co">#&gt; BM_Canonical_HighSNR                                 Canonical HRF (SPMG1), high SNR, 3 conditions, fixed amplitudes per condition</span></span>
<span><span class="co">#&gt; BM_Canonical_LowSNR                                   Canonical HRF (SPMG1), low SNR, 3 conditions, fixed amplitudes per condition</span></span>
<span><span class="co">#&gt; BM_HRF_Variability_AcrossVoxels                                         HRF varies across voxel groups, 2 conditions, moderate SNR</span></span>
<span><span class="co">#&gt; BM_Trial_Amplitude_Variability                              Single condition with significant trial-to-trial amplitude variability</span></span>
<span><span class="co">#&gt; BM_Complex_Realistic            Complex realistic scenario: 3 HRF groups, 3 conditions, variable durations/amplitudes, AR(2) noise</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-and-exploring-a-dataset">Loading and Exploring a Dataset<a class="anchor" aria-label="anchor" href="#loading-and-exploring-a-dataset"></a>
</h2>
<p>Let’s load the high SNR canonical dataset and explore its
structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the high SNR dataset</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_benchmark_dataset.html">load_benchmark_dataset</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get a summary of the dataset</span></span>
<span><span class="va">summary_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_benchmark_summary.html">get_benchmark_summary</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_info</span><span class="op">$</span><span class="va">dimensions</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n_timepoints</span></span>
<span><span class="co">#&gt; [1] 150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_voxels</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_events</span></span>
<span><span class="co">#&gt; [1] 45</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n_conditions</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">summary_info</span><span class="op">$</span><span class="va">experimental_design</span><span class="op">)</span></span>
<span><span class="co">#&gt; $conditions</span></span>
<span><span class="co">#&gt; [1] "Cond1" "Cond2" "Cond3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events_per_condition</span></span>
<span><span class="co">#&gt; $events_per_condition$Cond1</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events_per_condition$Cond2</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $events_per_condition$Cond3</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TR</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total_time</span></span>
<span><span class="co">#&gt; [1] 300</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target_snr</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next">Next<a class="anchor" aria-label="anchor" href="#next"></a>
</h2>
<ul>
<li>07 Group Analysis</li>
</ul>
</div>
<div class="section level2">
<h2 id="examining-the-data-structure">Examining the Data Structure<a class="anchor" aria-label="anchor" href="#examining-the-data-structure"></a>
</h2>
<p>Each benchmark dataset is a list. Key components include:</p>
<ul>
<li>
<code>description</code>: A text summary.</li>
<li>
<code>Y_noisy</code>: The matrix of noisy BOLD time series (time
points x voxels).</li>
<li>
<code>Y_clean</code>: (When available) The BOLD signal without
noise.</li>
<li>
<code>event_onsets</code>: Vector of event start times.</li>
<li>
<code>condition_labels</code>: Vector of condition names for each
event.</li>
<li>
<code>event_durations</code>: Vector of event durations.</li>
<li>
<code>true_betas_condition</code>: Ground truth beta values for each
condition.</li>
<li>
<code>true_hrf_parameters</code>: Information about the HRF used in
simulation.</li>
<li>
<code>TR</code>, <code>total_time</code>, <code>run_length</code>:
Scan parameters.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Look at the BOLD time series dimensions and event structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Y_noisy BOLD data dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Y_noisy BOLD data dimensions: 150 100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Number of events:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">event_onsets</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of events: 45</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Conditions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">condition_labels</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Conditions: Cond1 Cond2 Cond3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Events per condition:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">condition_labels</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Events per condition: 15 15 15</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"TR:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">TR</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; TR: 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Run length:"</span>, <span class="va">data</span><span class="op">$</span><span class="va">run_length</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Run length:</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizing-the-data">Visualizing the Data<a class="anchor" aria-label="anchor" href="#visualizing-the-data"></a>
</h2>
<p>Let’s visualize some aspects of the benchmark dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the first few voxels' time series</span></span>
<span><span class="va">n_timepoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span><span class="op">)</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, by <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">TR</span>, length.out <span class="op">=</span> <span class="va">n_timepoints</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">time_points</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  BOLD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Voxel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Voxel"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_timepoints</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add event markers</span></span>
<span><span class="va">event_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Time <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">event_onsets</span>,</span>
<span>  Condition <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">condition_labels</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">BOLD</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">event_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">Time</span>, color <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.7</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Voxel</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"BOLD Time Series with Event Markers"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time (seconds)"</span>, y <span class="op">=</span> <span class="st">"BOLD Signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmark_datasets_files/figure-html/visualize_data-1.png" alt="Figure illustrating dataset structure or evaluation results; see caption and text for details." width="960"></p>
</div>
<div class="section level2">
<h2 id="creating-design-matrices">Creating Design Matrices<a class="anchor" aria-label="anchor" href="#creating-design-matrices"></a>
</h2>
<p>One of the key features is the ability to create design matrices with
different HRF assumptions:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create design matrix with the true HRF (canonical)</span></span>
<span><span class="va">X_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_design_matrix_from_benchmark.html">create_design_matrix_from_benchmark</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span>, <span class="fu">fmrihrf</span><span class="fu">::</span><span class="va"><a href="https://bbuchsbaum.github.io/fmrihrf/reference/HRF_objects.html" class="external-link">HRF_SPMG1</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create design matrix with a different HRF (e.g., a Gaussian HRF instead of canonical)</span></span>
<span><span class="va">X_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_design_matrix_from_benchmark.html">create_design_matrix_from_benchmark</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span>, <span class="fu">fmrihrf</span><span class="fu">::</span><span class="va"><a href="https://bbuchsbaum.github.io/fmrihrf/reference/HRF_objects.html" class="external-link">HRF_GAUSSIAN</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True HRF design matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X_true</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; True HRF design matrix dimensions: 150 4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alternative HRF design matrix dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X_wrong</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Alternative HRF design matrix dimensions: 150 4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="method-evaluation-example">Method Evaluation Example<a class="anchor" aria-label="anchor" href="#method-evaluation-example"></a>
</h2>
<p>Let’s demonstrate how to evaluate a simple method (OLS) on the
benchmark dataset:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit ordinary least squares with the correct HRF</span></span>
<span><span class="va">betas_correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X_true</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X_true</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X_true</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span></span>
<span></span>
<span><span class="co"># Fit OLS with the wrong HRF assumption</span></span>
<span><span class="va">betas_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X_wrong</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X_wrong</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X_wrong</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">data</span><span class="op">$</span><span class="va">Y_noisy</span></span>
<span></span>
<span><span class="co"># Evaluate performance (remove intercept for comparison)</span></span>
<span><span class="va">performance_correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_method_performance.html">evaluate_method_performance</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span>, </span>
<span>                                                   <span class="va">betas_correct</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, </span>
<span>                                                   <span class="st">"OLS_Correct_HRF"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">performance_wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_method_performance.html">evaluate_method_performance</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span>, </span>
<span>                                                 <span class="va">betas_wrong</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, </span>
<span>                                                 <span class="st">"OLS_Wrong_HRF"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correct HRF - Overall correlation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">performance_correct</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correct HRF - Overall correlation: 0.989</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Wrong HRF - Overall correlation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">performance_wrong</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrong HRF - Overall correlation: 0.99</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correct HRF - RMSE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">performance_correct</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">rmse</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correct HRF - RMSE: 0.044</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Wrong HRF - RMSE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">performance_wrong</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">rmse</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wrong HRF - RMSE: 8.415</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparing-true-vs-estimated-betas">Comparing True vs Estimated Betas<a class="anchor" aria-label="anchor" href="#comparing-true-vs-estimated-betas"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get true betas</span></span>
<span><span class="va">true_betas</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">true_betas_condition</span></span>
<span></span>
<span><span class="co"># Create comparison plots</span></span>
<span><span class="va">comparison_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">true_betas</span><span class="op">)</span>,</span>
<span>  Estimated_Correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">betas_correct</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>  Estimated_Wrong <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">betas_wrong</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>  Condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Condition"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">true_betas</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot true vs estimated (correct HRF)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">True</span>, y <span class="op">=</span> <span class="va">Estimated_Correct</span>, color <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Correct HRF"</span>, x <span class="op">=</span> <span class="st">"True Beta"</span>, y <span class="op">=</span> <span class="st">"Estimated Beta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot true vs estimated (wrong HRF)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">True</span>, y <span class="op">=</span> <span class="va">Estimated_Wrong</span>, color <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wrong HRF"</span>, x <span class="op">=</span> <span class="st">"True Beta"</span>, y <span class="op">=</span> <span class="st">"Estimated Beta"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display plots side by side</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmark_datasets_files/figure-html/compare_betas-1.png" alt="Figure illustrating dataset structure or evaluation results; see caption and text for details." width="960"></p>
</div>
<div class="section level2">
<h2 id="testing-different-datasets">Testing Different Datasets<a class="anchor" aria-label="anchor" href="#testing-different-datasets"></a>
</h2>
<p>Let’s compare performance across different benchmark scenarios:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test on different datasets</span></span>
<span><span class="va">datasets_to_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BM_Canonical_HighSNR"</span>, <span class="st">"BM_Canonical_LowSNR"</span><span class="op">)</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">dataset_name</span> <span class="kw">in</span> <span class="va">datasets_to_test</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Load dataset and create design matrix</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_design_matrix_from_benchmark.html">create_design_matrix_from_benchmark</a></span><span class="op">(</span><span class="va">dataset_name</span>, <span class="fu">fmrihrf</span><span class="fu">::</span><span class="va"><a href="https://bbuchsbaum.github.io/fmrihrf/reference/HRF_objects.html" class="external-link">HRF_SPMG1</a></span><span class="op">)</span></span>
<span>  <span class="va">data_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_benchmark_dataset.html">load_benchmark_dataset</a></span><span class="op">(</span><span class="va">dataset_name</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Fit model</span></span>
<span>  <span class="va">betas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">data_test</span><span class="op">$</span><span class="va">Y_noisy</span></span>
<span>  </span>
<span>  <span class="co"># Evaluate performance</span></span>
<span>  <span class="va">perf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_method_performance.html">evaluate_method_performance</a></span><span class="op">(</span><span class="va">dataset_name</span>, <span class="va">betas</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">]</span>, <span class="st">"OLS"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">dataset_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    correlation <span class="op">=</span> <span class="va">perf</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">correlation</span>,</span>
<span>    rmse <span class="op">=</span> <span class="va">perf</span><span class="op">$</span><span class="va">overall_metrics</span><span class="op">$</span><span class="va">rmse</span>,</span>
<span>    target_snr <span class="op">=</span> <span class="va">data_test</span><span class="op">$</span><span class="va">target_snr</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Dataset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span>,</span>
<span>  Correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">correlation</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">rmse</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Target_SNR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">target_snr</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                   Dataset Correlation  RMSE Target_SNR</span></span>
<span><span class="co">#&gt; BM_Canonical_HighSNR BM_Canonical_HighSNR       0.989 0.044        4.0</span></span>
<span><span class="co">#&gt; BM_Canonical_LowSNR   BM_Canonical_LowSNR       0.595 0.410        0.5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="hrf-variability-dataset">HRF Variability Dataset<a class="anchor" aria-label="anchor" href="#hrf-variability-dataset"></a>
</h2>
<p>Let’s explore the dataset with HRF variability across voxels:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the HRF variability dataset</span></span>
<span><span class="va">hrf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_benchmark_dataset.html">load_benchmark_dataset</a></span><span class="op">(</span><span class="st">"BM_HRF_Variability_AcrossVoxels"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the HRF group assignments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"HRF group assignments:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">hrf_data</span><span class="op">$</span><span class="va">true_hrf_group_assignment</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; HRF group assignments: 50 50</span></span>
<span></span>
<span><span class="co"># Note: The actual HRF objects used vary by voxel</span></span>
<span><span class="co"># The benchmark dataset contains voxels with different HRF shapes to test</span></span>
<span><span class="co"># methods that can handle HRF variability across the brain</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="trial-amplitude-variability">Trial Amplitude Variability<a class="anchor" aria-label="anchor" href="#trial-amplitude-variability"></a>
</h2>
<p>Let’s examine the trial-to-trial variability dataset:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the trial variability dataset</span></span>
<span><span class="va">trial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_benchmark_dataset.html">load_benchmark_dataset</a></span><span class="op">(</span><span class="st">"BM_Trial_Amplitude_Variability"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at the trial-wise amplitudes</span></span>
<span><span class="va">true_trial_amps</span> <span class="op">&lt;-</span> <span class="va">trial_data</span><span class="op">$</span><span class="va">true_amplitudes_trial</span></span>
<span></span>
<span><span class="co"># Plot amplitude variability across trials for first few voxels</span></span>
<span><span class="va">amp_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">true_trial_amps</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Amplitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_trial_amps</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">true_trial_amps</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">true_trial_amps</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Voxel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Voxel"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">true_trial_amps</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">amp_plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Trial</span>, y <span class="op">=</span> <span class="va">Amplitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Voxel</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Trial-to-Trial Amplitude Variability"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Trial Number"</span>, y <span class="op">=</span> <span class="st">"True Amplitude"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="benchmark_datasets_files/figure-html/trial_variability-1.png" alt="Figure illustrating dataset structure or evaluation results; see caption and text for details." width="768"></p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The fMRI benchmark datasets provide a comprehensive testing framework
for:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Basic validation</strong>: Use
<code>BM_Canonical_HighSNR</code> for initial method testing</li>
<li>
<strong>Noise robustness</strong>: Compare performance between high
and low SNR datasets</li>
<li>
<strong>HRF estimation</strong>: Test methods on
<code>BM_HRF_Variability_AcrossVoxels</code>
</li>
<li>
<strong>Single-trial analysis</strong>: Evaluate LSS methods on
<code>BM_Trial_Amplitude_Variability</code>
</li>
<li>
<strong>Complex scenarios</strong>: Challenge methods with
<code>BM_Complex_Realistic</code>
</li>
</ol>
<p>Key advantages:</p>
<ul>
<li>
<strong>Known ground truth</strong>: All parameters are precisely
controlled and recorded</li>
<li>
<strong>Realistic noise models</strong>: AR(1) and AR(2) noise with
physiologically plausible parameters</li>
<li>
<strong>Comprehensive evaluation</strong>: Built-in performance
metrics and comparison tools</li>
<li>
<strong>Reproducible</strong>: Fixed random seeds ensure consistent
results</li>
<li>
<strong>Extensible</strong>: Framework allows easy addition of new
benchmark scenarios</li>
</ul>
<p>These datasets enable rigorous, standardized evaluation of fMRI
analysis methods and facilitate fair comparisons between different
approaches.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/bbuchsbaum" class="external-link">Bradley Buchsbaum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
