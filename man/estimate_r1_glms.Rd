% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rank1_estimation.R
\name{estimate_r1_glms}
\alias{estimate_r1_glms}
\title{Estimate betas using Rank-1 GLM with separate designs (Mumford-style approach)}
\usage{
estimate_r1_glms(dset, xdat, hrf_basis, hrf_ref, maxit = 100)
}
\arguments{
\item{dset}{An \code{fmri_dataset} object containing voxel data and mask}

\item{xdat}{A list typically returned by \code{get_X()}, containing:
\itemize{
\item \code{X}: The \emph{stacked} design matrix of dimension \eqn{n \times (k*m)}
\item \code{Base}: The baseline design matrix, dimension \eqn{n \times p}
}}

\item{hrf_basis}{A \eqn{T \times m} matrix of HRF basis functions}

\item{hrf_ref}{A length-\eqn{T} vector representing a reference HRF shape}

\item{maxit}{Maximum number of L-BFGS-B iterations (default 100)}
}
\value{
A list containing:
\item{beta_matrix}{A \eqn{k \times nvox} matrix of estimated condition amplitudes}
\item{estimated_hrf}{A \eqn{T \times nvox} matrix of the per-voxel estimated HRF shape}
}
\description{
This function estimates single-trial (or single-condition) betas in a rank-1
framework by splitting the design matrix \code{xdat$X} into a list of separate
sub-designs (\code{X_list}), one for each condition (or event). It then calls
\code{r1_glms_betas()} to jointly estimate the HRF shape and the per-condition
amplitudes.
}
\details{
This is the \emph{"Rank-1 GLM with Separate Designs"} approach (sometimes
called the Mumford method). We partition \code{xdat$X} into \eqn{k} sub-designs,
each \eqn{n \times m}. For each voxel, we remove the baseline using
\code{\link{lsfit}} and call \code{\link{r1_glms_betas}} to solve for the
event-wise betas under a rank-1 HRF constraint.
}
\keyword{internal}
