% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmri_meta.R
\name{fmri_meta}
\alias{fmri_meta}
\title{Fit Group-Level Meta-Analysis}
\usage{
fmri_meta(
  data,
  formula = ~1,
  method = c("pm", "fe", "dl", "reml"),
  robust = c("none", "huber", "t"),
  weights = c("ivw", "equal", "custom"),
  weights_custom = NULL,
  combine = NULL,
  chunk_size = 10000,
  n_threads = getOption("fmrireg.num_threads", 0),
  verbose = TRUE
)
}
\arguments{
\item{data}{A group_data object created by \code{\link{group_data}}}

\item{formula}{Formula specifying the meta-regression model. Default is ~ 1 (intercept only).
Use ~ 1 + group for group comparisons, or include continuous covariates.}

\item{method}{Character string specifying the meta-analysis method:
\itemize{
\item "fe": Fixed-effects (inverse variance weighted)
\item "pm": Paule-Mandel random-effects (default, good for whole-brain)
\item "dl": DerSimonian-Laird random-effects
\item "reml": Restricted maximum likelihood random-effects
}}

\item{robust}{Character string specifying robust estimation:
\itemize{
\item "none": No robust estimation (default)
\item "huber": Huber M-estimator with IRLS
\item "t": Student-t mixture model (for heavy-tailed distributions)
}}

\item{weights}{Character string specifying weighting scheme:
\itemize{
\item "ivw": Inverse variance weighting (default)
\item "equal": Equal weights for all subjects
\item "custom": User-provided weights (must supply weights argument)
}}

\item{weights_custom}{Numeric vector of custom weights (required if weights = "custom")}

\item{combine}{For t-statistic only data, combination method:
\itemize{
\item "stouffer": Stouffer's Z-score method
\item "fisher": Fisher's combined probability test
}}

\item{chunk_size}{Number of voxels to process at once (default: 10000)}

\item{n_threads}{Number of parallel threads to use. Defaults to fmrireg.num_threads option.}

\item{verbose}{Logical. Print progress messages (default: TRUE)}
}
\value{
An fmri_meta object containing:
\itemize{
\item coefficients: Meta-regression coefficients
\item se: Standard errors
\item tau2: Between-study variance (for random-effects)
\item I2: I-squared heterogeneity statistic
\item Q: Cochran's Q statistic
\item model: Model specification
\item data: Input group_data object
}
}
\description{
Performs voxelwise or ROI-based meta-analysis on group fMRI data using
fixed-effects, random-effects, or robust methods. Supports meta-regression
with covariates for group comparisons and other moderator analyses.
}
\examples{
\dontrun{
# Simple fixed-effects meta-analysis
fit <- fmri_meta(gd, method = "fe")

# Random-effects with group comparison
fit <- fmri_meta(gd, formula = ~ 1 + group, method = "pm")

# Robust meta-regression with continuous covariate
fit <- fmri_meta(gd, formula = ~ 1 + age + sex, method = "reml", robust = "huber")

# Stouffer's Z for t-statistics only
fit <- fmri_meta(gd_tstat, combine = "stouffer")
}
}
