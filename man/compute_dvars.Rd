% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/volume_quality.R
\name{compute_dvars}
\alias{compute_dvars}
\title{Compute DVARS (Temporal Derivative of Timecourses)}
\usage{
compute_dvars(Y, normalize = TRUE)
}
\arguments{
\item{Y}{Numeric matrix of fMRI data (time x voxels).}

\item{normalize}{Logical. If TRUE, normalize by median DVARS. Default TRUE.}
}
\value{
Numeric vector of length nrow(Y) with DVARS values.
The first timepoint is set to the median of subsequent values.
}
\description{
DVARS measures the root mean square of the temporal derivative across
all voxels, providing a single quality metric per volume. High DVARS
indicates rapid signal changes, often associated with motion artifacts.
}
\examples{
# Simulate fMRI data with a motion spike
set.seed(123)
Y <- matrix(rnorm(100 * 50), nrow = 100, ncol = 50)
Y[50, ] <- Y[50, ] + 5  # Add spike at volume 50
dvars <- compute_dvars(Y)
# dvars[50] will be elevated compared to other volumes

# Identify suspect volumes (normalized DVARS > 1.5)
suspect <- which(dvars > 1.5)
cat("Suspect volumes:", suspect, "\n")
}
