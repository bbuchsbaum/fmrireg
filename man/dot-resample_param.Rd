% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate.R
\name{.resample_param}
\alias{.resample_param}
\title{Simulate fMRI Time Courses, Return Shared Onsets + Column-Specific Amplitudes/Durations}
\usage{
.resample_param(
  base,
  sd,
  dist = c("lognormal", "gamma", "gaussian"),
  allow_negative = FALSE
)
}
\arguments{
\item{n}{Number of time-series (columns).}

\item{total_time}{Numeric. Total scan length (seconds).}

\item{TR}{Numeric. Repetition time (seconds).}

\item{hrf}{Hemodynamic response function, e.g. \code{HRF_SPMG1}.}

\item{n_events}{Number of events (ignored if \code{onsets} is provided).}

\item{onsets}{Optional numeric vector of event onsets. If \code{NULL}, will be generated.}

\item{isi_dist}{One of \code{"even"}, \code{"uniform"}, or \code{"exponential"}.
Default is \code{"even"} so events are evenly spaced from 0..total_time.}

\item{isi_min, isi_max}{For \code{isi_dist="uniform"}.}

\item{isi_rate}{For \code{isi_dist="exponential"}.}

\item{durations}{Numeric, scalar or length-\code{n_events}. If \code{duration_sd>0},
random sampling is done per column.}

\item{duration_sd}{Numeric. If >0, random variation in durations.}

\item{duration_dist}{\code{"lognormal"} or \code{"gamma"} (strictly positive).}

\item{amplitudes}{Numeric, scalar or length-\code{n_events}. If \code{amplitude_sd>0},
random sampling is done per column.}

\item{amplitude_sd}{Numeric. If >0, random variation in amplitudes.}

\item{amplitude_dist}{\code{"lognormal"}, \code{"gamma"}, or \code{"gaussian"} (can be negative).}

\item{single_trial}{If TRUE, each event is a separate single-trial regressor that gets summed.}

\item{noise_type}{\code{"none"}, \code{"white"}, \code{"ar1"}, or \code{"ar2"}.}

\item{noise_ar}{Numeric vector for AR(1) or AR(2). If missing or insufficient,
defaults are used (0.3 for AR(1); c(0.3,0.2) for AR(2)).}

\item{noise_sd}{Std dev of the noise.}

\item{random_seed}{Optional integer for reproducibility.}

\item{verbose}{If TRUE, prints messages.}
}
\value{
A list containing:
\describe{
\item{\code{time_series}}{A \code{matrix_dataset} with \eqn{T \times n} data
and \code{event_table} for the \emph{first} column's random draws.}
\item{\code{ampmat}}{An \eqn{n\_events \times n} numeric matrix of amplitudes.}
\item{\code{durmat}}{An \eqn{n\_events \times n} numeric matrix of durations.}
\item{\code{hrf_info}}{A list with HRF metadata.}
\item{\code{noise_params}}{A list describing noise generation.}
}
}
\description{
Generates \eqn{n} time-series (columns) with a single set of onsets, but
\emph{resampled} amplitudes/durations for each column if \code{amplitude_sd>0}
or \code{duration_sd>0}. Each column also gets independent noise. The result
is a list containing:
\itemize{
\item \code{time_series}: a \code{matrix_dataset} with \eqn{T \times n}.
The \code{event_table} uses the first column's amplitude/duration draws.
\item \code{ampmat}: an \eqn{n\_events \times n} matrix of per-column amplitudes.
\item \code{durmat}: an \eqn{n\_events \times n} matrix of per-column durations.
\item \code{hrf_info}: info about the HRF.
\item \code{noise_params}: info about noise generation (type + AR coefficients + SD).
}
}
\details{
\itemize{
\item If \code{noise_type="ar1"} and you do not provide \code{noise_ar}, we
default to \code{c(0.3)}.
\item If \code{noise_type="ar2"} and you do not provide a 2-element \code{noise_ar},
we default to \code{c(0.3, 0.2)}.
\item Onsets are either provided or generated once for all columns.
\item \strong{Amplitudes/durations} are re-sampled \emph{inside the loop} so each
column can differ randomly. The final arrays \code{ampmat} and \code{durmat}
each have one column per time-series.
\item The \code{matrix_dataset}'s \code{event_table} records the first column's
amplitudes/durations. If you need each column's, see \code{ampmat} and
\code{durmat}.
}
}
