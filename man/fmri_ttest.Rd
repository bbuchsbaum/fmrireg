% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmri_ttest.R
\name{fmri_ttest}
\alias{fmri_ttest}
\title{fmrireg t-tests for Group Analysis}
\usage{
fmri_ttest(
  gd,
  formula = ~1,
  engine = c("auto", "meta", "classic", "welch"),
  paired = FALSE,
  mu0 = 0,
  contrast = NULL,
  mc = NULL,
  alpha = 0.05,
  sign = c("AminusB", "BminusA"),
  mask = NULL,
  voxelwise_cov = NULL,
  center_voxelwise = TRUE,
  voxel_name = "voxel_cov",
  weights = c("ivw", "equal", "custom"),
  weights_custom = NULL,
  combine = NULL
)
}
\arguments{
\item{gd}{A group_data object or data frame with subject data}

\item{formula}{R formula for between-subjects design. Examples:
\itemize{
\item ~ 1: One-sample t-test
\item ~ 1 + group: Two-sample t-test
\item ~ 1 + group + age: ANCOVA with covariate
}}

\item{engine}{Character string; analysis engine to use:
\itemize{
\item "auto": Automatically select based on data (default)
\item "meta": Use inverse-variance meta-analysis (requires SE)
\item "classic": Use OLS/Student t-test
\item "welch": Use Welch t-test for unequal variances
}}

\item{paired}{Logical; if TRUE, perform paired t-test on differences (default: FALSE)}

\item{mu0}{Numeric scalar; constant to test against for one-sample tests (default: 0)}

\item{contrast}{Optional named numeric vector for linear combination of coefficients}

\item{mc}{Character string or NULL; multiple comparisons correction:
\itemize{
\item NULL: No correction (default)
\item "bh": Benjamini-Hochberg FDR
\item "spatial_fdr": Spatially-aware FDR
}}

\item{alpha}{Numeric scalar; FDR level if mc is not NULL (default: 0.05)}

\item{sign}{Character string; sign convention for group differences:
\itemize{
\item "AminusB": A - B (default)
\item "BminusA": B - A
}}

\item{mask}{Optional mask object or path}

\item{voxelwise_cov}{Optional S x P matrix of voxelwise covariates}

\item{center_voxelwise}{Logical; center voxelwise covariate per feature (default: TRUE)}

\item{voxel_name}{Character string; name for voxelwise coefficient (default: "voxel_cov")}

\item{weights}{Character string for meta-engine weighting: "ivw" (default,
uses provided SE), "equal" (equal weights), or "custom" (supply
\code{weights_custom}). Ignored for classic/welch engines.}

\item{weights_custom}{Numeric vector (length S) or matrix (S x P) of custom
weights when \code{weights = "custom"}.}

\item{combine}{Optional. When using the meta engine with t-only inputs
(i.e., per-subject t-statistics and df), specify the t-combination
method: "stouffer", "fisher", or "lancaster". Passed through to
\code{fmri_meta()} when delegating to the meta engine on group_data_*.}
}
\value{
An fmri_ttest_fit object containing:
\itemize{
\item beta: Matrix of coefficients
\item se: Matrix of standard errors (if available)
\item t: Matrix of t-statistics (classic engine)
\item z: Matrix of z-scores
\item p: Matrix of p-values
\item df: Matrix of degrees of freedom
\item q: Matrix of FDR-adjusted p-values (if mc is used)
}
}
\description{
Performs group-level t-tests on fMRI data with support for one-sample, two-sample,
paired, and ANCOVA designs. Provides both meta-analysis and classical t-test engines,
mirroring AFNI 3dttest++ functionality within the fmrireg framework.
}
\examples{
\dontrun{
# One-sample t-test
fit <- fmri_ttest(gd, formula = ~ 1)

# Two-sample t-test
fit <- fmri_ttest(gd, formula = ~ 1 + group)

# Paired t-test
fit <- fmri_ttest(gd_diff, formula = ~ 1, paired = TRUE)

# ANCOVA with age covariate
fit <- fmri_ttest(gd, formula = ~ 1 + group + age)

# With spatial FDR correction
fit <- fmri_ttest(gd, formula = ~ 1 + group, mc = "spatial_fdr", alpha = 0.05)
}

}
