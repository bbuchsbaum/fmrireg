% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fracridge.R
\name{fracridge_cv}
\alias{fracridge_cv}
\title{Fractional Ridge Regression with Cross-Validation}
\usage{
fracridge_cv(
  X,
  y,
  frac_grid = seq(0.1, 1, by = 0.1),
  tol = 1e-10,
  cv = 5,
  scoring = "r2"
)
}
\arguments{
\item{X}{A numeric matrix of shape \code{(n, p)} representing the design matrix,
where \code{n} is the number of observations and \code{p} is the number of predictors.}

\item{y}{A numeric vector or matrix of shape \code{(n, b)} representing the response variable(s),
where \code{b} is the number of targets. If \code{y} is a vector, it is treated as a single target.}

\item{frac_grid}{A numeric vector specifying the grid of fractions to consider for cross-validation.
Must be sorted in increasing order and be between 0 and 1. Default is \code{seq(0.1, 1.0, by = 0.1)}.}

\item{tol}{A numeric value specifying the tolerance below which singular values are considered zero.
Must be positive. Default is \code{1e-10}.}

\item{cv}{An integer specifying the number of cross-validation folds, or an object to be used
as a cross-validation generator (e.g., \code{cv = 5}). Default is \code{5}.}

\item{scoring}{A character string or function to evaluate the predictions on the test set.
Default is \code{"r2"}.}
}
\value{
An object of class \code{fracridge_cv} containing:
\describe{
\item{\code{best_frac}}{The fraction that achieved the best cross-validated score.}
\item{\code{coef}}{A numeric array of shape \code{(p, b)} containing the estimated coefficients
for the best fraction and each target.}
\item{\code{alpha}}{A numeric vector containing the regularization parameters associated with the best fraction
for each target.}
\item{\code{cv_results}}{A data frame containing cross-validation scores for each fraction.}
}
}
\description{
Performs fractional ridge regression with cross-validation to select the optimal fraction.
}
\details{
This function performs fractional ridge regression across a grid of fractions and selects the
fraction that maximizes the cross-validated performance metric (e.g., R-squared).
}
\examples{
\dontrun{
# Generate random data
set.seed(1)
X <- matrix(rnorm(100 * 10), nrow = 100, ncol = 10)
y <- rnorm(100)

# Perform cross-validated fractional ridge regression
cv_result <- fracridge_cv(X, y, frac_grid = seq(0.1, 1.0, by = 0.1))

# Print the best fraction
print(cv_result$best_frac)

# Inspect coefficients
print(cv_result$coef)
}

}
