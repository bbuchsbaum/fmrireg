% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/meta_fit.R
\name{fmri_meta_fit}
\alias{fmri_meta_fit}
\title{Fit Meta-Analysis Models}
\usage{
fmri_meta_fit(
  Y,
  V,
  X,
  method = c("pm", "dl", "fe", "reml"),
  robust = c("none", "huber"),
  huber_c = 1.345,
  robust_iter = 2,
  n_threads = getOption("fmrireg.num_threads", 0)
)
}
\arguments{
\item{Y}{Numeric matrix of effect sizes (subjects x features)}

\item{V}{Numeric matrix of variances (subjects x features)}

\item{X}{Numeric matrix; design matrix (subjects x predictors), including intercept}

\item{method}{Character scalar; meta-analysis method: "pm" (Paule-Mandel), "dl" (DerSimonian-Laird),
"fe" (fixed-effects), or "reml" (REML, uses PM solver)}

\item{robust}{Character scalar; robust estimation method: "none" or "huber"}

\item{huber_c}{Numeric scalar; tuning constant for Huber M-estimator (default: 1.345).
Smaller values provide more robust estimates but may reduce efficiency.}

\item{robust_iter}{Integer scalar; number of IRLS iterations for robust estimation (default: 2)}

\item{n_threads}{Integer scalar; number of OpenMP threads (0 = use all available)}
}
\value{
List with components:
\item{beta}{Numeric matrix of coefficients (predictors x features)}
\item{se}{Numeric matrix of standard errors (predictors x features)}
\item{z}{Numeric matrix of z-scores (predictors x features)}
\item{tau2}{Numeric vector of between-study variance estimates}
\item{Q_fe}{Numeric vector of Q statistics from fixed-effects model}
\item{I2_fe}{Numeric vector of IÂ² statistics from fixed-effects model}
\item{df}{Numeric vector of degrees of freedom}
\item{ok}{Logical vector indicating successful fits}
}
\description{
Low-level function that calls the C++ meta-analysis implementation.
This is typically called internally by higher-level functions like fmri_meta().
}
\seealso{
\code{\link{fmri_meta}}
}
