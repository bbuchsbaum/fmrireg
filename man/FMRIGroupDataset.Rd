% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmri_group_dataset.R
\name{FMRIGroupDataset}
\alias{FMRIGroupDataset}
\title{R6 Class for Managing Multi-Subject fMRI Datasets}
\description{
The FMRIGroupDataset class provides a container and interface for managing multiple
fMRI datasets, typically representing different subjects in a study. It supports
operations like subsetting, applying functions across subjects, and accessing
individual subject data.

The class is designed to work with the BIDS (Brain Imaging Data Structure) format
and integrates with the bidser package for BIDS data handling.
}
\section{Key Features}{
\itemize{
\item Manages multiple fMRI datasets with consistent interface
\item Supports subject-wise operations and filtering
\item Integrates with BIDS format and bidser package
\item Provides method chaining for complex operations
}
}

\section{Class Structure}{
The class maintains:
\itemize{
\item A list of individual fMRI datasets
\item Subject IDs corresponding to each dataset
\item Optional task and run information
\item Methods for data access and manipulation
}
}

\examples{
\dontrun{
# Create individual datasets
ds1 <- fmri_dataset("sub-01_task-rest_bold.nii.gz", mask="mask.nii.gz", TR=2)
ds2 <- fmri_dataset("sub-02_task-rest_bold.nii.gz", mask="mask.nii.gz", TR=2)

# Create group dataset
group_ds <- FMRIGroupDataset$new(
  datasets = list(ds1, ds2),
  subject_ids = c("sub-01", "sub-02"),
  tasks = c("rest")
)

# Get specific subject's data
sub1_data <- group_ds$get_subject("sub-01")

# Apply function to all subjects
results <- group_ds$apply(function(ds, subj) {
  # Process individual dataset
  list(
    subject = subj,
    mean_signal = colMeans(get_data(ds))
  )
})

# Subset to specific subjects
subset_ds <- group_ds$subset(c("sub-01"))
}


## ------------------------------------------------
## Method `FMRIGroupDataset$new`
## ------------------------------------------------

\dontrun{
# Basic creation
group_ds <- FMRIGroupDataset$new(
  datasets = list(ds1, ds2),
  subject_ids = c("sub-01", "sub-02")
)

# With task and run information
group_ds <- FMRIGroupDataset$new(
  datasets = list(ds1, ds2),
  subject_ids = c("sub-01", "sub-02"),
  tasks = c("rest", "task"),
  runs = c("run-01", "run-02")
)
}

## ------------------------------------------------
## Method `FMRIGroupDataset$get_subject`
## ------------------------------------------------

\dontrun{
# Get single subject's dataset
sub1_ds <- group_ds$get_subject("sub-01")

# Use in pipeline
sub1_ds \%>\% 
  get_data() \%>\%
  process_data()
}

## ------------------------------------------------
## Method `FMRIGroupDataset$apply`
## ------------------------------------------------

\dontrun{
# Simple mean calculation
means <- group_ds$apply(function(ds, subj) {
  colMeans(get_data(ds))
})

# More complex analysis
results <- group_ds$apply(function(ds, subj, threshold) {
  list(
    subject = subj,
    data = analyze_subject(ds, threshold = threshold)
  )
}, threshold = 0.05)
}

## ------------------------------------------------
## Method `FMRIGroupDataset$subset`
## ------------------------------------------------

\dontrun{
# Basic subsetting
sub_ds <- group_ds$subset(c("sub-01", "sub-02"))

# Chain operations
results <- group_ds$
  subset(c("sub-01", "sub-02"))$
  apply(analyze_subject)
}
}
\seealso{
\itemize{
\item \code{\link[=fmri_dataset]{fmri_dataset()}} for individual dataset creation
\item \code{\link[bidser:bids_project]{bidser::bids_project()}} for BIDS project handling
}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{datasets}}{List of individual fMRI datasets
Each element should be an object inheriting from class "fmri_dataset"}

\item{\code{subject_ids}}{Vector of subject IDs
Character vector of BIDS-compliant subject identifiers (e.g., "sub-01")}

\item{\code{tasks}}{Vector of task names
Optional character vector of task names present in the datasets}

\item{\code{runs}}{Vector of run IDs
Optional character vector of run identifiers}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-FMRIGroupDataset-new}{\code{FMRIGroupDataset$new()}}
\item \href{#method-FMRIGroupDataset-get_subject}{\code{FMRIGroupDataset$get_subject()}}
\item \href{#method-FMRIGroupDataset-get_tasks}{\code{FMRIGroupDataset$get_tasks()}}
\item \href{#method-FMRIGroupDataset-get_runs}{\code{FMRIGroupDataset$get_runs()}}
\item \href{#method-FMRIGroupDataset-apply}{\code{FMRIGroupDataset$apply()}}
\item \href{#method-FMRIGroupDataset-subset}{\code{FMRIGroupDataset$subset()}}
\item \href{#method-FMRIGroupDataset-print}{\code{FMRIGroupDataset$print()}}
\item \href{#method-FMRIGroupDataset-clone}{\code{FMRIGroupDataset$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-new"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-new}{}}}
\subsection{Method \code{new()}}{
Create a new FMRIGroupDataset object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$new(datasets, subject_ids, tasks = NULL, runs = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{datasets}}{List of individual fmri_dataset objects}

\item{\code{subject_ids}}{Vector of subject IDs corresponding to datasets}

\item{\code{tasks}}{Optional vector of task names}

\item{\code{runs}}{Optional vector of run IDs}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new FMRIGroupDataset object
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
# Basic creation
group_ds <- FMRIGroupDataset$new(
  datasets = list(ds1, ds2),
  subject_ids = c("sub-01", "sub-02")
)

# With task and run information
group_ds <- FMRIGroupDataset$new(
  datasets = list(ds1, ds2),
  subject_ids = c("sub-01", "sub-02"),
  tasks = c("rest", "task"),
  runs = c("run-01", "run-02")
)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-get_subject"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-get_subject}{}}}
\subsection{Method \code{get_subject()}}{
Retrieve dataset for a specific subject
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$get_subject(subject_id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{subject_id}}{Character string specifying the subject ID}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
The fmri_dataset object for the specified subject
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
# Get single subject's dataset
sub1_ds <- group_ds$get_subject("sub-01")

# Use in pipeline
sub1_ds \%>\% 
  get_data() \%>\%
  process_data()
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-get_tasks"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-get_tasks}{}}}
\subsection{Method \code{get_tasks()}}{
Get all unique tasks across datasets
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$get_tasks()}\if{html}{\out{</div>}}
}

\subsection{Details}{
Returns explicitly set tasks if available, otherwise
discovers unique tasks across all datasets
}

\subsection{Returns}{
Character vector of task names
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-get_runs"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-get_runs}{}}}
\subsection{Method \code{get_runs()}}{
Get all unique runs across datasets
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$get_runs()}\if{html}{\out{</div>}}
}

\subsection{Details}{
Returns explicitly set runs if available, otherwise
discovers unique runs across all datasets
}

\subsection{Returns}{
Character vector of run IDs
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-apply"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-apply}{}}}
\subsection{Method \code{apply()}}{
Apply a function to each dataset
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$apply(fun, ...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{fun}}{Function to apply to each dataset}

\item{\code{...}}{Additional arguments passed to fun}
}
\if{html}{\out{</div>}}
}
\subsection{Details}{
The function \code{fun} should accept at least two arguments:
\itemize{
\item dataset: The individual fmri_dataset object
\item subject_id: The ID of the current subject
}
}

\subsection{Returns}{
List of results from applying fun to each dataset
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
# Simple mean calculation
means <- group_ds$apply(function(ds, subj) {
  colMeans(get_data(ds))
})

# More complex analysis
results <- group_ds$apply(function(ds, subj, threshold) {
  list(
    subject = subj,
    data = analyze_subject(ds, threshold = threshold)
  )
}, threshold = 0.05)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-subset"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-subset}{}}}
\subsection{Method \code{subset()}}{
Create new dataset containing only specified subjects
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$subset(subject_ids)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{subject_ids}}{Character vector of subject IDs to keep}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new FMRIGroupDataset containing only the specified subjects
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
# Basic subsetting
sub_ds <- group_ds$subset(c("sub-01", "sub-02"))

# Chain operations
results <- group_ds$
  subset(c("sub-01", "sub-02"))$
  apply(analyze_subject)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-print"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-print}{}}}
\subsection{Method \code{print()}}{
Print summary of group dataset
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$print()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Invisibly returns self (for method chaining)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-FMRIGroupDataset-clone"></a>}}
\if{latex}{\out{\hypertarget{method-FMRIGroupDataset-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{FMRIGroupDataset$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
