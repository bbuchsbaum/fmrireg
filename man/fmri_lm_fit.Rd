% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmrilm.R
\name{fmri_lm_fit}
\alias{fmri_lm_fit}
\title{Fit an fMRI Linear Regression Model with a Specified Fitting Strategy}
\usage{
fmri_lm_fit(
  fmrimod,
  dataset,
  strategy = c("runwise", "chunkwise"),
  robust = FALSE,
  robust_psi = c("huber", "bisquare"),
  robust_k_huber = 1.345,
  robust_c_tukey = 4.685,
  robust_max_iter = 2L,
  robust_scale_scope = c("run", "global"),
  nchunks = 10,
  use_fast_path = FALSE,
  progress = FALSE,
  ...
)
}
\arguments{
\item{fmrimod}{An \code{fmri_model} object.}

\item{dataset}{An \code{fmri_dataset} object containing the time-series data.}

\item{strategy}{The data splitting strategy, either \code{"runwise"} or \code{"chunkwise"}. Default is \code{"runwise"}.}

\item{robust}{Logical. Whether to use robust fitting. Default is \code{FALSE}.}

\item{robust_psi}{Psi-function for row-wise weights when robust fitting is enabled. Either \code{"huber"} or \code{"bisquare"}.}
\item{robust_k_huber}{Tuning constant \code{k} for Huber weighting.}
\item{robust_c_tukey}{Tuning constant \code{c} for Tukey bisquare weighting.}
\item{robust_max_iter}{Maximum number of IRLS iterations.}
\item{robust_scale_scope}{Scope for robust scale estimation, \code{"run"} or \code{"global"}.}
\item{nchunks}{Number of data chunks when strategy is \code{"chunkwise"}. Default is \code{10}.}

\item{use_fast_path}{Logical. If \code{TRUE}, use matrix-based computation for speed. Default is \code{FALSE}.}

\item{progress}{Logical. Whether to display a progress bar during model fitting. Default is \code{FALSE}.}

\item{...}{Additional arguments.}
}
\value{
A fitted fMRI linear regression model with the specified fitting strategy.
}
\description{
This function fits an fMRI linear regression model using the specified \code{fmri_model} object, dataset,
and data splitting strategy (either \code{"runwise"} or \code{"chunkwise"}). When \code{robust = TRUE}, row-wise weights are computed in an Iteratively Reweighted Least Squares loop to down-weight frames with large residuals. Standard errors are based on a robust scale estimate, so resulting p-values are approximate. This function is primarily an internal worker used by \code{fmri_lm}.
}
\seealso{
\code{\link{fmri_lm}}, \code{\link{fmri_model}}, \code{\link{fmri_dataset}}
}
\keyword{internal}
