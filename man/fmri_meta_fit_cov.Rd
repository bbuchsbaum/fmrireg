% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/meta_fit.R
\name{fmri_meta_fit_cov}
\alias{fmri_meta_fit_cov}
\title{Fit Meta-Analysis and return packed covariance per voxel}
\usage{
fmri_meta_fit_cov(
  Y,
  V,
  X,
  method = c("pm", "dl", "fe", "reml"),
  robust = c("none", "huber"),
  huber_c = 1.345,
  robust_iter = 2,
  n_threads = getOption("fmrireg.num_threads", 0)
)
}
\arguments{
\item{Y}{Numeric matrix of effect sizes (subjects x features)}

\item{V}{Numeric matrix of variances (subjects x features)}

\item{X}{Numeric matrix; design matrix (subjects x predictors), including intercept}

\item{method}{Character scalar; meta-analysis method: "pm" (Paule-Mandel), "dl" (DerSimonian-Laird),
"fe" (fixed-effects), or "reml" (REML, uses PM solver)}

\item{robust}{Character scalar; robust estimation method: "none" or "huber"}

\item{huber_c}{Numeric scalar; tuning constant for Huber M-estimator (default: 1.345).
Smaller values provide more robust estimates but may reduce efficiency.}

\item{robust_iter}{Integer scalar; number of IRLS iterations for robust estimation (default: 2)}

\item{n_threads}{Integer scalar; number of OpenMP threads (0 = use all available)}
}
\value{
List with base outputs and cov_tri (tsize x P) where tsize = K*(K+1)/2
}
\description{
Fit Meta-Analysis and return packed covariance per voxel
}
