% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap.R
\name{multiresponse_bootstrap_lm}
\alias{multiresponse_bootstrap_lm}
\title{Multiresponse bootstrap linear model}
\usage{
multiresponse_bootstrap_lm(
  form,
  data_env,
  conlist,
  vnames,
  fcon,
  modmat = NULL,
  block_size = 30,
  boot_rows = FALSE,
  nboot = 100,
  event_indices
)
}
\arguments{
\item{form}{Formula for the linear model. Required if modmat is NULL.}

\item{data_env}{Environment containing the data for the linear model.}

\item{conlist}{List of contrasts to be computed for each bootstrap sample.}

\item{vnames}{Vector of variable names.}

\item{fcon}{Contrasts for fixed effects.}

\item{modmat}{Optional pre-computed model matrix. If provided, form is ignored.}

\item{block_size}{Size of the blocks for the bootstrap (default: 30).
Should be large enough to capture temporal dependencies but small enough
to allow sufficient randomization.}

\item{boot_rows}{Logical flag indicating whether to bootstrap rows (default: FALSE).}

\item{nboot}{Number of bootstrap iterations (default: 100).}

\item{event_indices}{Indices of events for computing beta covariances.}
}
\value{
A list containing:
\itemize{
\item original: The fitted original model with contrasts
\item con_cov: Covariance matrices for contrasts (if contrasts provided)
\item beta_cov: Covariance matrices for beta estimates
\item nboot: Number of bootstrap iterations performed
\item bootstrap: Logical indicating this is a bootstrap result
}
}
\description{
Performs block bootstrap resampling for multiresponse linear models, particularly
useful for fMRI time series data where temporal dependencies exist. The function
implements a block bootstrap approach to maintain the temporal correlation structure
within the data.
}
\details{
The function performs the following steps:
\enumerate{
\item Fits the original linear model
\item Implements block bootstrap resampling of residuals
\item Reconstructs response variables using fitted values and resampled residuals
\item Computes contrasts for each bootstrap sample
}

The block bootstrap approach helps preserve temporal dependencies in the data by
resampling blocks of consecutive observations rather than individual observations.
}
\keyword{internal}
