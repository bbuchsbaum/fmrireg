% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fmri_betas.R
\name{estimate_betas.fmri_dataset}
\alias{estimate_betas.fmri_dataset}
\title{Estimate betas using various regression methods}
\usage{
\method{estimate_betas}{fmri_dataset}(
  x,
  fixed = NULL,
  ran,
  block,
  method = c("mixed", "mixed_cpp", "lss", "lss_naive", "lss_cpp", "pls", "pls_global",
    "ols"),
  basemod = NULL,
  maxit = 1000,
  fracs = 0.5,
  progress = TRUE,
  ...
)
}
\arguments{
\item{x}{An object of class \code{fmri_dataset} representing the fMRI dataset.}

\item{fixed}{A formula specifying the fixed regressors that model constant effects (i.e., non-varying over trials).}

\item{ran}{A formula specifying the random (trialwise) regressors that model single trial effects.}

\item{block}{A formula specifying the block factor.}

\item{method}{The regression method for estimating trialwise betas; one of "mixed", "mixed_cpp", "lss", "lss_naive", "lss_cpp", "pls", "pls_global", or "ols".}

\item{basemod}{A \code{baseline_model} instance to regress out of data before beta estimation (default: NULL).}

\item{maxit}{Maximum number of iterations for optimization methods (default: 1000).}

\item{fracs}{Fraction of voxels used for prewhitening.}

\item{progress}{Logical; show progress bar.}

\item{...}{Additional arguments passed to the estimation method.}
}
\value{
A list of class "fmri_betas" containing the following components:
\itemize{
\item betas_fixed: NeuroVec object representing the fixed effect betas.
\item betas_ran: NeuroVec object representing the random effect betas.
\item design_ran: Design matrix for random effects.
\item design_fixed: Design matrix for fixed effects.
\item design_base: Design matrix for baseline model.
\item basemod: Baseline model object.
\item fixed_model: Fixed effect model object.
\item ran_model: Random effect model object.
\item estimated_hrf: The estimated HRF vector (NULL for most methods).
}
}
\description{
This function estimates betas (regression coefficients) for fixed and random effects
using various regression methods including mixed models, least squares, and PLS.
}
\examples{
\dontrun{
facedes <- read.table(system.file("extdata", "face_design.txt", package = "fmrireg"), header=TRUE)
facedes$frun <- factor(facedes$run)
scans <- paste0("rscan0", 1:6, ".nii")

dset <- fmri_dataset(scans=scans, mask="mask.nii", TR=1.5, 
        run_length=rep(436,6), event_table=facedes)
fixed = onset ~ hrf(run)
ran = onset ~ trialwise()
block = ~ run

betas <- estimate_betas(dset, fixed=fixed, ran=ran, block=block, method="mixed")
}
}
\seealso{
\code{\link{fmri_dataset}}, \code{\link{baseline_model}}, \code{\link{event_model}}
}
